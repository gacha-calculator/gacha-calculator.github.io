var g=(e,s,m)=>{const u=e[s];return u?typeof u=="function"?u():Promise.resolve(u):new Promise((S,R)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(R.bind(null,new Error("Unknown variable dynamic import: "+s+(s.split("/").length!==m?". Note that variables only represent file names one level deep.":""))))})};let c=!1,a=null,l=null,t=null,d=0,i,o,n;const f=10;let r,p;self.onmessage=function(e){switch(e.data?.type){case"Iterate":if(!c){self.postMessage({type:"Error",message:"Not initialized"});return}d++,n=d===f,i=e.data.lossData.charRankUps,o=e.data.lossData.wepRankUps,i.pullsSum>0&&(r.rankUpSR(a,i,t.ODDS_SR,t.SR_PITY),n&&p.pruneAndNormalize(a)),o.pullsSum>0&&(r.rankUpSR(l,o,t.ODDS_SR,t.SR_PITY),n&&p.pruneAndNormalize(l)),n&&(d=0),self.postMessage({type:"IterationComplete"});break;case"IterateLast":if(!c){self.postMessage({type:"Error",message:"Not initialized"});return}i=e.data.lossData.charRankUps,o=e.data.lossData.wepRankUps,i.pullsSum>0&&(n||p.pruneAndNormalize(a),r.rankUpSR(a,i,t.ODDS_SR,t.SR_PITY)),o.pullsSum>0&&(n||p.pruneAndNormalize(l),r.rankUpSR(l,o,t.ODDS_SR,t.SR_PITY)),self.postMessage({type:"LastIteration",distributionCharSR:a,distributionWepSR:l});break;case"Initiate":Promise.all([g(Object.assign({"../../../games/R1999/R1999-pull-logic.js":()=>import("./R1999-pull-logic-D5GF5WT8.js"),"../../../games/common/common-pull-logic.js":()=>import("./common-pull-logic-Dh2Y5ybP.js"),"../../../games/genshin/genshin-pull-logic.js":()=>import("./genshin-pull-logic-Pe4RtljL.js"),"../../../games/wuwa/wuwa-pull-logic.js":()=>import("./wuwa-pull-logic-DnSkwhdU.js"),"../../../games/zenless/zenless-pull-logic.js":()=>import("./zenless-pull-logic-yGDQyFD1.js")}),`../../../games/${e.data.context.moduleType.pullLogic}/${e.data.context.moduleType.pullLogic}-pull-logic.js`,6),g(Object.assign({"../../../games/R1999/R1999-helpers.js":()=>import("./R1999-helpers-Bcwiz0nM.js"),"../../../games/common/common-helpers.js":()=>import("./common-helpers-B2WE4zNo.js"),"../../../games/genshin/genshin-helpers.js":()=>import("./genshin-helpers-BIwKO5JD.js"),"../../../games/wuwa/wuwa-helpers.js":()=>import("./wuwa-helpers-B_hitJ3O.js")}),`../../../games/${e.data.context.moduleType.helpers}/${e.data.context.moduleType.helpers}-helpers.js`,6)]).then(([s,m])=>{r=s,p=m,a=e.data.distribution.distributionCharSR,l=e.data.distribution.distributionWepSR,t=e.data.context.contextSR,c=!0,self.postMessage({type:"InitComplete"})}).catch(s=>{console.error("Failed to load modules:",s),self.postMessage({type:"InitError",error:s.message})});break;default:console.warn("Unknown type:",e.data?.type)}};
