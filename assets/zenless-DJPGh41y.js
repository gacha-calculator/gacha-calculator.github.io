import{c as y,D as f,C as A,r as E,a as P,u as v,g as k,b as L,d as I,e as O,i as N,f as _,j as D,h as x,k as h,l as d,s as S,m as M}from"./solvers-CbfgVQJ-.js";/* empty css               */import{c as W,W as z,g as w,a as H}from"./cashback-AJXKrhPS.js";import{c as B,n as F,s as U,a as Y,b as Z,d as V}from"./common-helpers-BPUYLRbn.js";import{r as q,s as G,m as j,a as J}from"./common-pull-logic-BkvWLwop.js";const C={CHARACTER:"character",WEAPON:"weapon"},o={PITY_ROW:"[data-banner]",CONSTELLATION_ROW:"[data-rarity]",PITY_TABLE:"#pity-table",CONSTELLATION_TABLE:"#constellation-table"},m={pitySettings:{[C.CHARACTER]:{pity4:0,pity5:0},[C.WEAPON]:{pity4:0,pity5:0}},isCharacter:!0,isWeapon:!0,isSpecial:!1,constellationColumns:8},R={probability:70,pulls:119},r=[.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.066,.126,.186,.246,.306,.366,.426,.486,.546,.606,.666,.726,.786,.846,.906,.966,1],l=[.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.077,.147,.217,.287,.357,.427,.497,.567,.637,.707,.777,.847,.917,.987,1],c=[.051,.051,.051,.051,.051,.051,.051,.051,.561,1],e={maxCharacterConstelation:6,rateUpCharacterSR:2,rateUpWeaponSR:2,poolStandardCharSSR:6,poolCharSR:11,configSR:{maxType:7,regularPoints:.4,specialPoints:1},configSSR:{maxType:7,regularPoints:2,specialPoints:5},configWep:{pointsSR:.4,pointsSSR:2},paths:{char:["None","m0","m1","m2","m3","m4","m5","m6"],wep:["None","r1","r2","r3","r4","r5"]},pity:{pitySSRChar:r.length,pitySSRWep:l.length,pitySRChar:c.length,pitySRWep:c.length},default:0},$=[{value:"unknown",text:"Unknown"},{value:"none",text:"Not Owned"},{value:"m0",text:"M0"},{value:"m1",text:"M1"},{value:"m2",text:"M2"},{value:"m3",text:"M3"},{value:"m4",text:"M4"},{value:"m5",text:"M5"},{value:"m6",text:"M6"}],K={none:0,m0:1,m1:2,m2:3,m3:4,m4:5,m5:6,m6:7};class Q{constructor(t){this.parts=t,this.persistence=y("zzz",o);const n=W({cashbackCalculator:this.parts.cashbackFn,uiUpdater:this.parts.updateTableFn}),s={getPageConfiguration:O,getLabels:I,getPullPlan:L,getTarget:k,updateChart:v,convertToChartData:P,recalcInputs:E,calculatorFunction:this.parts.runCalcFn,calculatorConfig:{gachaConfig:this.parts.gachaConfig,CONSTELLATION_MAP:this.parts.CONSTELLATION_MAP},pageConfig:{SELECTORS:o,INITIAL_CONFIG:m},postCalculationHooks:[n],persistence:this.persistence};this.validator=new f(this.parts.CONSTELLATION_MAP),this.calculationHandler=new A(s),this.calculateBtn=document.getElementById("calculate-btn"),this.exportBtn=document.getElementById("export-btn")}initialize(){this.validator.initialize(),N(this.persistence,this.parts.gachaConfig,this.validator,m,$,o),_(),this.#t(),this.#i()}#t(){if(!this.calculateBtn){console.error("Calculate button not found!");return}this.calculateBtn.addEventListener("click",()=>{this.#a()&&this.calculationHandler.runCalculation()}),this.exportBtn&&this.exportBtn.addEventListener("click",()=>D(this.persistence)),x(this.persistence,null,this.validator)}#a(){if(document.querySelectorAll(".is-invalid").forEach(i=>i.classList.remove("is-invalid")),this.validator.isDataValid())return!0;console.warn("Validation failed. Calculation blocked."),this.validator.validateAll();const t=document.querySelectorAll(".is-invalid"),n=new Set;t.forEach(i=>{const p=i.closest(".tab-pane");if(p){const u=document.querySelector(`.tab-link[data-tab-target="#${p.id}"]`);u&&n.add(u)}i.classList.add("flicker"),i.addEventListener("animationend",()=>i.classList.remove("flicker"),{once:!0})}),n.forEach(i=>{i.classList.add("is-invalid","flicker"),i.addEventListener("animationend",()=>i.classList.remove("flicker"),{once:!0})});const s=Array.from(n)[0];return s&&s.click(),setTimeout(()=>{t[0]?.scrollIntoView({behavior:"smooth",block:"center"})},100),!1}#i(){const t=this.persistence.loadCalculation(),n=t?t.input:null;t?(h(this.parts.gachaConfig.paths,n),d(R,t),S(t.persistInput)):(h(this.parts.gachaConfig.paths),d(R),S()),this.calculationHandler.runCalculation()}}const X="common",T=e.pity.pitySSRChar,b=e.pity.pitySSRWep,t0=e.pity.pitySRChar,g={CHARACTER:e.pity.pitySSRChar*2+1,WEAPON:e.pity.pitySSRWep*2+1,SR:e.pity.pitySRChar*2+1},a0={distributionArrays:{makeSSR:(a,t)=>J(a,t,g),makeSR:a=>j(a,g),sortPity:a=>G(a,e.pity)},pullLogic:{rankUpSSRCheap:(a,t)=>q(a,r,l,T,b,t)},workerManager:new z,contexts:{contextSSR:{ODDS_CHARACTER_SSR:r,ODDS_WEAPON_SSR:l,SSR_CHAR_PITY:T,SSR_WEP_PITY:b},contextSR:{ODDS_SR:c,SR_PITY:t0},moduleType:X},helpers:{consolidateDistributionForCashback:V,consolidateProbabilitiesCheap:Z,consolidateProbabilities:Y,simplifyDistribution:U,normalizeCheap:F,checkIsEmpty:B}};function i0(a,t){return new w(e,a0).runGachaCalculation(a,t)}document.addEventListener("DOMContentLoaded",()=>{const a={gachaConfig:e,CONSTELLATION_MAP:K,runCalcFn:i0,cashbackFn:H,updateTableFn:M};new Q(a).initialize()});
