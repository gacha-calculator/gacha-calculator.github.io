var f=(e,s,m)=>{const u=e[s];return u?typeof u=="function"?u():Promise.resolve(u):new Promise((R,g)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(g.bind(null,new Error("Unknown variable dynamic import: "+s+(s.split("/").length!==m?". Note that variables only represent file names one level deep.":""))))})};let d=!1,a=null,o=null,t=null,c=0,i,n,r;const S=10;let l,p;self.onmessage=function(e){switch(e.data?.type){case"Iterate":if(!d){self.postMessage({type:"Error",message:"Not initialized"});return}c++,r=c===S,i=e.data.lossData.charLoss,n=e.data.lossData.wepLoss,i>0&&(l.rankUpSR(a,i,t.ODDS_SR,t.SR_PITY),r&&p.pruneAndNormalize(a)),n>0&&(l.rankUpSR(o,n,t.ODDS_SR,t.SR_PITY),r&&p.pruneAndNormalize(o)),r&&(c=0),self.postMessage({type:"IterationComplete"});break;case"IterateLast":if(!d){self.postMessage({type:"Error",message:"Not initialized"});return}i=e.data.lossData.charLoss,n=e.data.lossData.wepLoss,i>0&&(r||p.pruneAndNormalize(a),l.rankUpSR(a,i,t.ODDS_SR,t.SR_PITY)),n>0&&(r||p.pruneAndNormalize(o),l.rankUpSR(o,n,t.ODDS_SR,t.SR_PITY)),self.postMessage({type:"LastIteration",distributionCharSR:a,distributionWepSR:o});break;case"Initiate":Promise.all([f(Object.assign({"../../../games/common/commonPullLogic.js":()=>import("./commonPullLogic-LN8Exh0w.js"),"../../../games/genshin/genshinPullLogic.js":()=>import("./genshinPullLogic-D0ClKzdp.js")}),`../../../games/${e.data.context.moduleType}/${e.data.context.moduleType}PullLogic.js`,6),f(Object.assign({"../../../games/common/commonHelpers.js":()=>import("./commonHelpers-CFzEYYvM.js"),"../../../games/genshin/genshinHelpers.js":()=>import("./genshinHelpers-CZTXOU8z.js")}),`../../../games/${e.data.context.moduleType}/${e.data.context.moduleType}Helpers.js`,6)]).then(([s,m])=>{l=s,p=m,a=e.data.distribution.distributionCharSR,o=e.data.distribution.distributionWepSR,t=e.data.context.contextSR,d=!0,self.postMessage({type:"InitComplete"})}).catch(s=>{console.error("Failed to load modules:",s),self.postMessage({type:"InitError",error:s.message})});break;default:console.warn("Unknown type:",e.data?.type)}};
