import{e as h,f as p,T as u,h as C,i as f,j as S,l as g,k as v,m as o,n as c,s as r,u as b,q as m}from"./cashback-DiFGDUic.js";/* empty css               */class T{constructor(t){this.parts=t,this.persistence=h("reverse");const i=p({cashbackCalculator:this.parts.cashbackFn,uiUpdater:this.parts.updateTableFn}),e={calculatorFunction:this.parts.runCalcFn,calculatorConfig:{gachaConfig:this.parts.gachaConfig,CONSTELLATION_MAP:this.parts.CONSTELLATION_MAP},postCalculationHooks:[i]};this.validator=new u(this.parts.CONSTELLATION_MAP),this.calculationHandler=C(e,this.persistence),this.calculateBtn=document.getElementById("calculate-btn"),this.exportBtn=document.getElementById("export-btn")}initialize(){this.validator.initialize(),f(this.persistence,this.parts.gachaConfig,this.validator),S(),this.#t(),this.#i()}#t(){if(!this.calculateBtn){console.error("Calculate button not found!");return}this.calculateBtn.addEventListener("click",()=>{this.#a()&&this.calculationHandler()}),this.exportBtn&&this.exportBtn.addEventListener("click",()=>g(this.persistence)),v(this.persistence,null,this.validator)}#a(){if(document.querySelectorAll(".is-invalid").forEach(a=>a.classList.remove("is-invalid")),this.validator.isDataValid())return!0;console.warn("Validation failed. Calculation blocked."),this.validator.validateAll();const t=document.querySelectorAll(".is-invalid"),i=new Set;t.forEach(a=>{const s=a.closest(".tab-pane");if(s){const l=document.querySelector(`.tab-link[data-tab-target="#${s.id}"]`);l&&i.add(l)}a.classList.add("flicker"),a.addEventListener("animationend",()=>a.classList.remove("flicker"),{once:!0})}),i.forEach(a=>{a.classList.add("is-invalid","flicker"),a.addEventListener("animationend",()=>a.classList.remove("flicker"),{once:!0})});const e=Array.from(i)[0];return e&&e.click(),setTimeout(()=>{t[0]?.scrollIntoView({behavior:"smooth",block:"center"})},100),!1}#i(){const t=this.persistence.loadCalculation(),i=t?t.input:null;t?(o(this.parts.gachaConfig.paths,i),c(t),r(t.persistInput)):(o(this.parts.gachaConfig.paths),c(),r()),this.calculationHandler()}}const R=[.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.006,.066,.126,.186,.246,.306,.366,.426,.486,.546,.606,.666,.726,.786,.846,.906,.966,1],k=[.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.007,.077,.147,.217,.287,.357,.427,.497,.567,.637,.707,.777,.847,.917,.987,1],d=[.051,.051,.051,.051,.051,.051,.051,.051,.561,1],L={maxCharacterConstelation:5,rateUpCharacterSR:3,rateUpWeaponSR:5,poolStandardCharSSR:8,poolCharSR:43,configSR:{maxType:7,regularPoints:2,specialPoints:5},configSSR:{maxType:7,regularPoints:10,specialPoints:25},configWep:{pointsSR:2,pointsSSR:10},pity:{pitySSRChar:R.length,pitySSRWep:k.length,pitySRChar:d.length,pitySRWep:d.length},default:0},E={none:0,c0:1,c1:2,c2:3,c3:4,c4:5,c5:6,c6:7};function P(n){}document.addEventListener("DOMContentLoaded",()=>{const n={gachaConfig:L,CONSTELLATION_MAP:E,runCalcFn:P,cashbackFn:m,updateTableFn:b};new T(n).initialize()});
