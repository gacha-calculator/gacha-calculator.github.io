(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=t(o);fetch(o.href,n)}})();function le(a,e,t,r,o,n){$(e.pity,r,n),_(e,r,n),U(o);const i=a.loadTables();i&&(I(i.pity,n),O(i.constellation,n),M(i.rateUps),t.validateAll()),a.init()}function ce(a){const e=a.loadButtons();e&&e.isHidden&&z()}function $(a,e,t){const r=document.getElementById("pity-row-template"),o=document.querySelector(`${t.PITY_TABLE} tbody`);Object.entries(e.pitySettings).forEach(([n,i])=>{const s=r.content.cloneNode(!0).querySelector("tr"),l=s.querySelector(".special-mechanic");s.dataset.validationType="individual";const u=s.querySelector('[data-control="pity-4"]'),c=s.querySelector('[data-control="pity-5"]');if(u&&(u.min=0,u.max=n.includes("weapon")?a.pitySRWep-1:a.pitySRChar-1),c&&(c.min=0,c.max=n.includes("weapon")?a.pitySSRWep-1:a.pitySSRChar-1),s.dataset.banner=n,s.querySelector(".banner-name").textContent=n,s.querySelector('[data-control="pity-4"]').value=i.pity4,s.querySelector('[data-control="pity-5"]').value=i.pity5,l){let h="";n==="character"?h=`<div class="button-container">
            <input type="number" data-control="capRad" class="custom-input" min="0" max="3" 
                   value="${i.caprad??0}">
                            <button class="help-btn" data-help-key="caprad-help"
                                aria-label="Help for Importing Pity Data">
                                ?
                            </button>
                        </div>`:n==="weapon"&&(h=`<div class="button-container">
            <input type="number" data-control="epPath" class="custom-input" min="0" max="1" 
                   value="${i.epPath??0}">
                            <button class="help-btn" data-help-key="eppath-help"
                                aria-label="Help for Importing Pity Data">
                                ?
                            </button>
                        </div>`),l.innerHTML=h}o.appendChild(s);const d=document.querySelector("#pity-table");d&&d.querySelectorAll('tbody tr input[type="number"]').forEach(h=>h.addEventListener("input",function(){let p=this.value;p.length>1&&p.startsWith("0")&&(this.value=p.replace(/^0+/,""),this.value===""&&(this.value="0"));let f=parseInt(this.value)||0;f>h.max?(this.value=h.max,E(this)):f<h.min&&(this.value=h.min,E(this))}))})}function _(a,e,t){const r=document.getElementById("const-column-template"),o=document.querySelectorAll(`${t.CONSTELLATION_TABLE} tbody tr`),n=a.poolStandardCharSSR,i=a.poolCharSR;o.forEach(s=>{const l=document.createDocumentFragment(),u=s.dataset.rarity;s.dataset.validationType="row-sum",s.dataset.targetSum=u==="5"?n:i;for(let c=0;c<e.constellationColumns;c++){const d=r.content.cloneNode(!0),h=d.querySelector("input");if(c===0){const p=u==="5"?n:i;h.value=p}h.addEventListener("input",()=>L(s)),h.addEventListener("input",function(){h.value.length>1&&h.value.startsWith("0")&&(h.value=h.value.replace(/^0+/,"")),h.value===""&&(h.value="0")}),l.appendChild(d)}s.appendChild(l),D(s),L(s)})}function D(a){const e=document.createElement("div");e.className="row-progress-bar",a.appendChild(e)}function L(a){const e=a.querySelectorAll("input"),t=parseInt(a.dataset.targetSum);let r=0;e.forEach(i=>{r+=parseInt(i.value)||0});const o=a.querySelector(".row-progress-bar"),n=Math.min(r/t*100,100);o.style.width=n+"%",n<60||r>t?o.style.background="rgba(244, 67, 54, 0.3)":n<80?o.style.background="rgba(241, 244, 54, 0.3)":o.style.background="rgba(54, 244, 79, 0.3)"}function U(a){const e=document.querySelectorAll("#rate-up-table select");if(e.length===0)return;const t=a.map(r=>`<option value="${r.value}">${r.text}</option>`).join("");e.forEach(r=>{r.innerHTML=t,r.value="unknown"})}function ue(a,e=null){const t=document.querySelector('[data-control="probability"]'),r=document.querySelector('[data-control="pulls"]');e?(t.value=e.targetProb||a.probability,r.value=e.targetPull||a.pulls):(t.value=a.probability,r.value=a.pulls),t.addEventListener("input",function(){let o=this.value;o.length>1&&o.startsWith("0")&&(this.value=o.replace(/^0+/,""),this.value===""&&(this.value="0"));let n=parseInt(this.value)||0;n>100?(this.value="100",E(this)):n===0&&(this.value="0")}),r.addEventListener("input",function(){let o=this.value;o.length>1&&o.startsWith("0")&&(this.value=o.replace(/^0+/,""),this.value===""&&(this.value="0"));let n=parseInt(this.value)||0;n>9999?this.value="9999":n<1&&(this.value="1")})}function E(a){a.style.borderColor="#a71919",a.style.outline="1px solid #a71919",a.classList.add("flicker"),setTimeout(()=>{a.classList.remove("flicker"),a.style.borderColor="",a.style.outline=""},500)}function de(a,e,t){const r=[];for(let n=0;n<a.length;n++){let i=0;for(const[s,l]of a[n].offRates)i+=l.prob;i=(i*100).toFixed(2),i>0&&r.push({name:e[n],probability:i,p10:t[n].LOWER_BOUND,mean:t[n].MEAN,p90:t[n].UPPER_BOUND,color:"#3498db"})}const o=document.querySelector("#probability-table tbody");o.innerHTML="",r.forEach(n=>{const i=document.createElement("tr"),s=n.probability;i.innerHTML=`
      <td>${n.name}</td>
      <td>
        <div class="progress-container">
          <div class="progress-bar" style="width:${s}%;background:${n.color}">
            <div class="progress-label">${n.probability}%</div>
          </div>
        </div>
      </td>
      <td class="cashback-value">${n.p10.toFixed(1)}</td>
      <td class="cashback-value highlight">${n.mean.toFixed(1)}</td>
      <td class="cashback-value">${n.p90.toFixed(1)}</td>
    `,o.appendChild(i)})}function I(a,e){a.forEach(t=>{const r=document.querySelector(`${e.PITY_TABLE} tr[data-banner="${t.banner}"]`);r&&(r.querySelector('[data-control="pity-4"]').value=t.pity4,r.querySelector('[data-control="pity-5"]').value=t.pity5,r.querySelector(".guarantee-4").checked=t.guarantee4,r.querySelector(".guarantee-5").checked=t.guarantee5,t.caprad&&r.querySelector('[data-control="capRad"]')&&(r.querySelector('[data-control="capRad"]').value=t.caprad),t.epPath&&r.querySelector('[data-control="epPath"]')&&(r.querySelector('[data-control="epPath"]').value=t.epPath))})}function O(a,e){document.querySelectorAll(`${e.CONSTELLATION_TABLE} tbody tr`).forEach((r,o)=>{const n=a[o];n&&r.querySelectorAll("td:nth-child(n+2) input").forEach((s,l)=>{n[l]!==void 0&&(s.value=n[l])})})}function M(a){if(!a||!Array.isArray(a))return;document.querySelectorAll("#rate-up-table select.custom-select").forEach((t,r)=>{a[r]!==void 0&&(t.value=a[r])})}function z(){document.querySelectorAll(".help-btn").forEach(e=>{e.classList.toggle("hidden")})}const W=[.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.04,.065,.09,.115,.14,.165,.19,.215,.24,1],he=.085,pe={maxCharacterConstelation:5,rateUpCharacterSR:2,poolStandardCharSSR:40,poolCharSR:23,configSR:{maxType:6,regularPoints:.3,specialPoints:.7},configSSR:{maxType:6,regularPoints:1.2,specialPoints:2.8},paths:{char:["None","p0","p1","p2","p3","p4","p5"]},pity:{pitySSR:W.length,pitySR:10},default:0},G=[{value:"unknown",text:"Unknown"},{value:"none",text:"Not Owned"},{value:"p0",text:"P0"},{value:"p1",text:"P1"},{value:"p2",text:"P2"},{value:"p3",text:"P3"},{value:"p4",text:"P4"},{value:"p5",text:"P5"},{value:"new",text:"New Character"}],fe={none:0,p0:1,p1:2,p2:3,p3:4,p4:5,p5:6},ye=["1.0","1.1","1.2","1.3","1.4","1.5","1.6","1.7","1.8","1.9","2.0","2.1","2.2","2.3","2.4","2.5","2.6","2.7","AC","2.8","3.0"],ge={"One Gram of Curiosity":{char:"Sotheby",release:"1.0"},"Clang of Sword & Armor":{char:"A Knight",release:"1.0"},"Pop is Everything":{char:"Melania",release:"1.1"},"Thus Spoke The Border Collie":{char:"Pickles",release:"1.1"},"The Fairies Shining at Night":{char:"Tooth Fairy",release:"1.2"},"The Changeling Awaits":{char:"Jessica",release:"1.2"},"That Steady Evening Star":{char:"Kaalaa Baunaa",release:"1.3"},"Another Spring Thaw":{char:"Shamane",release:"1.3"},"Beyond the World of Matters":{char:"37",release:"1.4"},"Seeker in the Cave":{char:"6",release:"1.4"},"The Chirps of Flame":{char:"Spathodea",release:"1.5"},"The Spores of Peace":{char:"Ezra Theodore",release:"1.5"},"Over the New Leaf":{char:"Getian",release:"1.6"},"Vissi D'arte, Vissi D'amore":{char:"Isolde",release:"1.7"},"Reading in Sea Breeze":{char:"Marcus",release:"1.7"},"Ode to the Utopia":{char:"Vila",release:"1.8"},"The Intersecting Lines":{char:"Windsong",release:"1.8"},"Into the Mirrors":{char:"Kakania",release:"1.9"},"Calming Hues in Frenzied Nights":{char:"Mercuria",release:"2.0"},"Clash n' Slash":{char:"J",release:"2.0"},"Blue Lullaby":{char:"Tuesday",release:"2.1"},"Shooting in the Dark":{char:"Argus",release:"2.1"},"Fledgling's First Flight":{char:"Lopera",release:"2.2"},"When the Swan Dances":{char:"Willow",release:"2.3"},"The Book of Whys":{char:"Flutterpage",release:"2.3"},"Playing in Rainbow Clef":{char:"Barcarola",release:"2.4"},"A Shell on the Waves":{char:"Fatutu",release:"2.4"},"A Life in Montage":{char:"Noire",release:"2.5"},"A Writing Writer Written":{char:"Recoleta",release:"2.6"},"The Shattered Product":{char:"Aleph",release:"2.6"},"Serpentine Century":{char:"Hissabeth",release:"2.7"},"Wirewalking in Zero Gravity":{char:"Kiperina",release:"2.7"},"From the Ruin of the Past":{char:"Moldir",release:"2.8"},"A Beating Heart Beneath the Stone":{char:"Sentinel",release:"3.0"},"The Mourner's Eulogy":{char:"Charon",release:"3.0"}},F={CHARACTER:"character"},S={PITY_ROW:"[data-banner]",CONSTELLATION_ROW:"[data-rarity]",PITY_TABLE:"#pity-table",CONSTELLATION_TABLE:"#constellation-table"},q={pitySettings:{[F.CHARACTER]:{pity4:0,pity5:0}},isCharacter:!0,isWeapon:!1,isSpecial:!1,constellationColumns:7},be={probability:70,pulls:76};function me(a,e,t){Y(e.pity),V(e),X();const r=a.loadTables();r&&(B(r.pity),N(r.constellation),J(r.rateUps),t.validateAll()),a.init()}function Y(a){const e=document.getElementById("pity-row-template"),t=document.querySelector(`${S.PITY_TABLE} tbody`);Object.entries(q.pitySettings).forEach(([o,n])=>{const i=e.content.cloneNode(!0).querySelector("tr");i.dataset.validationType="individual";const s=i.querySelector('[data-control="pity-5"]');s&&(s.min=0,s.max=a.pitySSR-1),i.dataset.banner=o,i.querySelector(".banner-name").textContent=o,i.querySelector('[data-control="pity-5"]').value=n.pity5,t.appendChild(i)});const r=document.querySelector("#pity-table");r&&r.querySelectorAll('tbody tr input[type="number"]').forEach(o=>o.addEventListener("input",function(){let n=this.value;n.length>1&&n.startsWith("0")&&(this.value=n.replace(/^0+/,""),this.value===""&&(this.value="0"));let i=parseInt(this.value)||0;i>o.max?(this.value=o.max,C(this)):i<=o.min&&(this.value=o.min,C(this))}))}function C(a){a.style.borderColor="#a71919",a.style.outline="1px solid #a71919",a.classList.add("flicker"),setTimeout(()=>{a.classList.remove("flicker"),a.style.borderColor="",a.style.outline=""},500)}function V(a){const e=document.getElementById("const-column-template"),t=document.querySelectorAll(`${S.CONSTELLATION_TABLE} tbody tr`),r=a.poolStandardCharSSR,o=a.poolCharSR;t.forEach(n=>{const i=document.createDocumentFragment(),s=n.dataset.rarity;n.dataset.validationType="row-sum",n.dataset.targetSum=s==="5"?r:o;for(let l=0;l<q.constellationColumns;l++){const u=e.content.cloneNode(!0),c=u.querySelector("input");if(l===q.constellationColumns-1){const d=s==="5"?r:o;c.value=d}c.addEventListener("input",()=>x(n)),c.addEventListener("input",function(){c.value.length>1&&c.value.startsWith("0")&&(c.value=c.value.replace(/^0+/,"")),c.value===""&&(c.value="0")}),i.appendChild(u)}n.appendChild(i),j(n),x(n)})}function j(a){const e=document.createElement("div");e.className="row-progress-bar",a.appendChild(e)}function x(a){const e=a.querySelectorAll("input"),t=parseInt(a.dataset.targetSum);let r=0;e.forEach(i=>{r+=parseInt(i.value)||0});const o=a.querySelector(".row-progress-bar"),n=Math.min(r/t*100,100);o.style.width=n+"%",n<60||r>t?o.style.background="rgba(244, 67, 54, 0.3)":n<80?o.style.background="rgba(241, 244, 54, 0.3)":o.style.background="rgba(54, 244, 79, 0.3)"}function X(){const a=document.querySelectorAll("#rate-up-table select");if(a.length===0)return;const e=G.map(t=>`<option value="${t.value}">${t.text}</option>`).join("");a.forEach(t=>{t.innerHTML=e,t.value="unknown"})}function B(a){a.forEach(e=>{const t=document.querySelector(`${S.PITY_TABLE} tr[data-banner="${e.banner}"]`);t&&(t.querySelector('[data-control="pity-5"]').value=e.pity5,t.querySelector(".guarantee-5").checked=e.guarantee5)})}function N(a){document.querySelectorAll(`${S.CONSTELLATION_TABLE} tbody tr`).forEach((t,r)=>{const o=a[r];o&&t.querySelectorAll("td:nth-child(n+2) input").forEach((i,s)=>{o[s]!==void 0&&(i.value=o[s])})})}function J(a){if(!a||!Array.isArray(a))return;document.querySelectorAll("#rate-up-table select.custom-select").forEach((t,r)=>{a[r]!==void 0&&(t.value=a[r])})}function ve(a,e,t,r,o){const n=document.getElementById("import-file-input");if(!n){console.error("Import file input not found!");return}const i=s=>K(s,a,e,t,r,o);n.removeEventListener("change",n.__handleFile),n.addEventListener("change",i),n.__handleFile=i}async function K(a,e,t,r,o,n){const i=a.target.files[0];if(i)try{let s,l=null;const u=await i.text();i.type==="application/json"?(s=JSON.parse(u),s.exportFormat==="GachaCalculatorData"?l=s:t&&(l=t(s))):i.type==="text/csv"?l=t(u,e):alert("Error: Invalid or unsupported file format."),l&&(Q(l,o),r.validateAll(),e.saveTables())}catch(s){n.showError("Something's wrong with the file you tried to use"),console.error("File import error:",s)}finally{a.target.value=""}}function Q(a,e){a.game==="reverse"?(a.pity&&B(a.pity),a.constellation&&N(a.constellation)):(a.pity&&I(a.pity,e),a.constellation&&O(a.constellation,e))}function Se(a){const e={exportFormat:"GachaCalculatorData",version:"1.0",exportedAt:new Date().toISOString(),pity:a.getPityData(),constellation:a.getConstellationData()},t=JSON.stringify(e,null,2),r=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(r),n=document.createElement("a");n.href=o;const i=new Date().toISOString().slice(0,10);n.download=`gachaCalc-data-${i}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o),console.log("Data exported successfully.")}function Te(a,e=null){const t=new R(a,e);return t.initialize(),t}function Ee(a,e=null){return new Z(a,e).initialize()}class R{constructor(e,t=null){this.pathsConfig=e,this.savedData=t,this.groupColorMap=new Map,this.rowsContainer=document.querySelector(".rows-container"),this.addButton=document.getElementById("add-btn"),this.COLORS={UNIQUE_GROUP:"#f0f0f0",PRESET_HUES:[0,120,240,60,180,300]}}initialize(){this.rowsContainer.innerHTML="",this.savedData&&this.savedData.pullPlan?this.savedData.pullPlan.forEach(e=>{this.rowsContainer.appendChild(this.createRow(null,e))}):this.rowsContainer.appendChild(this.createRow()),this.addButton.addEventListener("click",()=>{this.rowsContainer.appendChild(this.createRow())})}createRow(e=null,t=null){const r=this.createRowElement();return this.setupRowEvents(r),this.initializeRowData(r,e,t),r}createRowElement(){return document.getElementById("row-template").content.cloneNode(!0).querySelector(".row")}setupRowEvents(e){const t=e.querySelector(".dropdown"),r=e.querySelector(".type-selector");this.setupDropdownHandler(e,t,r),this.setupTypeChangeHandler(e,r),this.setupGoalChangeChecker(e),this.setupButtonHandlers(e)}setupDropdownHandler(e,t,r){t.addEventListener("click",o=>{o.stopPropagation(),t.classList.toggle("dropdown--open")}),e.querySelectorAll(".dropdown__item").forEach(o=>{o.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),r.value=o.dataset.value,r.dispatchEvent(new Event("change")),t.classList.remove("dropdown--open")})}),document.addEventListener("click",o=>{t.contains(o.target)||t.classList.remove("dropdown--open")})}setupTypeChangeHandler(e,t){t.addEventListener("change",()=>{const r=t.options[t.selectedIndex],o=e.querySelector(".type-icon"),n=e.querySelector(".type-text");o.src=r.dataset.icon,n.textContent=r.textContent,this.updatePathSelector(e,t.value),this.handleTypeChangeGroupUpdate(e,t.value)})}setupGoalChangeChecker(e){const t=e.querySelector(".first-select"),r=e.querySelector(".second-select");t.addEventListener("change",()=>{const o=[];for(let u of t)o.push(u.value);o.push(r[r.length-1].value);const n=t.value,i=r.value,s=o.indexOf(n),l=o.indexOf(i);s>=l&&(r.value=o[s+1])}),r.addEventListener("change",()=>{const o=[];for(let u of t)o.push(u.value);o.push(r[r.length-1].value);const n=t.value,i=r.value,s=o.indexOf(n),l=o.indexOf(i);s>=l&&(t.value=o[l-1])})}handleTypeChangeGroupUpdate(e,t){const r=e.dataset.group;r&&!r.startsWith("unique")&&(e.dataset.group=`unique${t.charAt(0).toUpperCase()+t.slice(1)}`,e.style.setProperty("--group-color",this.COLORS.UNIQUE_GROUP))}setupButtonHandlers(e){e.querySelector(".btn--chainAdd").addEventListener("click",()=>{this.rowsContainer.appendChild(this.createRow(e))}),e.querySelector(".btn--delete").addEventListener("click",()=>{this.handleRowDeletion(e)})}handleRowDeletion(e){const t=e.dataset.group;t&&!t.startsWith("unique")&&Array.from(this.rowsContainer.querySelectorAll(".row")).filter(o=>o.dataset.group===t).length===1&&this.groupColorMap.delete(t),e.remove()}initializeRowData(e,t,r){r?this.initializeFromSavedData(e,r):t?this.initializeFromParent(e,t):this.initializeNewRow(e)}initializeFromSavedData(e,t){const r=e.querySelector(".type-selector");r.value=t.type||"char",this.updateVisualType(e,r.value),this.setGroupAndColor(e,t.group),this.updatePathSelector(e,r.value,t.from,t.to)}initializeFromParent(e,t){const r=t.dataset.group,o=t.querySelector(".type-selector").value,n=t.querySelector(".second-select").value,i=e.querySelector(".type-selector");i.value=o,this.updateVisualType(e,o),r.startsWith("unique")?this.convertToNewGroup(t,e):this.inheritExistingGroup(e,r),this.updatePathSelector(e,o,n)}convertToNewGroup(e,t){const r=this.generateNewGroupId(),o=this.getHueForGroup(r);[e,t].forEach(n=>{n.dataset.group=r,n.style.setProperty("--group-color",`hsl(${o}, 80%, 70%)`)}),this.groupColorMap.set(r,o)}inheritExistingGroup(e,t){e.dataset.group=t;const r=this.groupColorMap.get(t);r!==void 0&&e.style.setProperty("--group-color",`hsl(${r}, 80%, 70%)`)}initializeNewRow(e){const r=e.querySelector(".type-selector").value;e.dataset.group=`unique${r.charAt(0).toUpperCase()+r.slice(1)}`,e.style.setProperty("--group-color",this.COLORS.UNIQUE_GROUP),this.updatePathSelector(e,r)}updateVisualType(e,t){const r=e.querySelector(".type-selector"),o=r.options[r.selectedIndex],n=e.querySelector(".type-icon"),i=e.querySelector(".type-text");n.src=o.dataset.icon,i.textContent=o.textContent}updatePathSelector(e,t,r=null,o=null){const n=e.querySelector(".first-select"),i=e.querySelector(".second-select"),s=this.pathsConfig[t]||this.pathsConfig.char;this.populateSelect(n,s.slice(0,-1)),this.populateSelect(i,s.slice(1)),this.setInitialPathValues(n,i,s,r,o)}populateSelect(e,t){e.innerHTML="",t.forEach(r=>{const o=document.createElement("option");o.value=r,o.textContent=r,e.appendChild(o)})}setInitialPathValues(e,t,r,o,n){if(o&&r.includes(o)){e.value=o;const i=r.indexOf(o);t.value=n&&r.includes(n)&&r.indexOf(n)>i?n:r[Math.min(i+1,r.length-1)]}else e.value=r[0],t.value=r[1]}generateNewGroupId(){const e=Array.from(this.groupColorMap.keys()).map(t=>parseInt(t.replace(/\D/g,""))).filter(t=>!isNaN(t)).sort((t,r)=>t-r);for(let t=1;t<=e.length+1;t++)if(!e.includes(t))return`group${t}`;return`group${e.length+1}`}getHueForGroup(e){const t=parseInt(e.replace(/\D/g,""));return t<=this.COLORS.PRESET_HUES.length?this.COLORS.PRESET_HUES[t-1]:t*137.5%360}setGroupAndColor(e,t){if(e.dataset.group=t,t.startsWith("unique"))e.style.setProperty("--group-color",this.COLORS.UNIQUE_GROUP);else{let r=this.groupColorMap.get(t);r===void 0&&(parseInt(t.replace(/\D/g,"")),r=this.getHueForGroup(t),this.groupColorMap.set(t,r)),e.style.setProperty("--group-color",`hsl(${r}, 80%, 70%)`)}}getState(){return Array.from(this.rowsContainer.querySelectorAll(".row")).map(t=>({type:t.querySelector(".type-selector").value,from:t.querySelector(".first-select").value,to:t.querySelector(".second-select").value,group:t.dataset.group}))}}class Z extends R{constructor(e,t=null){super(e,t||null)}initialize(){return this.rowsContainer.innerHTML="",this.savedData&&this.savedData.pullPlan?this.savedData.pullPlan.forEach((e,t)=>{const r={...e,pity:this.savedData.pity4?.[t]||0,guarantee:this.savedData.guarantee4?.[t]||!1};this.rowsContainer.appendChild(this.createRow(null,r))}):this.rowsContainer.appendChild(this.createRow()),this.addButton.addEventListener("click",()=>{this.rowsContainer.appendChild(this.createRow())}),this}createRow(e=null,t=null){const r=super.createRow(e,t);return this.addPityGuaranteeToRow(r,t),r}addPityGuaranteeToRow(e,t){const r=e.querySelector('[data-control="pity-4"]'),o=e.querySelector(".guarantee-4");r!==null&&(t&&(r&&t.pity!==void 0&&(r.value=t.pity),o&&t.guarantee!==void 0&&(o.checked=t.guarantee)),r.addEventListener("input",function(){let n=this.value;n.length>1&&n.startsWith("0")&&(this.value=n.replace(/^0+/,""),this.value===""&&(this.value="0"));let i=parseInt(this.value)||0;i>10?(this.value=10,A(this)):i<0&&(this.value=0,A(this))}))}}function A(a){a.style.borderColor="#a71919",a.style.outline="1px solid #a71919",a.classList.add("flicker"),setTimeout(()=>{a.classList.remove("flicker"),a.style.borderColor="",a.style.outline=""},500)}function qe(a=null){const e=document.querySelector('[data-control="probability"]'),t=document.querySelector('[data-control="pulls"]'),r=document.querySelectorAll(".mode-label");let o;a?o=a:o="probability",n(),r.forEach(i=>{i.addEventListener("click",function(){o=this.getAttribute("data-target"),n()})}),e.addEventListener("input",function(){o="probability",n()}),t.addEventListener("input",function(){o="pulls",n()});function n(){r.forEach(i=>{const s=i.getAttribute("data-target")===o;i.classList.toggle("active",s)})}}function we(){const a=document.getElementById("expand-button"),e=document.getElementById("expandedMenu");let t=null;a&&a.addEventListener("click",()=>{a.classList.toggle("dropdown--open"),e.classList.toggle("active")});const r=document.querySelectorAll(".nav-list > li:has(.nav-button)");r.forEach(n=>{const i=n.querySelector(".nav-button");i.addEventListener("dragstart",function(s){t=n;const l=n.getBoundingClientRect(),u=s.clientX-l.left,c=s.clientY-l.top;s.dataTransfer.setDragImage(n,u,c),n.classList.add("dragging")}),i.addEventListener("dragend",function(){n.classList.remove("dragging"),t=null,document.querySelectorAll(".drop-zone").forEach(s=>s.classList.remove("drop-zone"))}),i.addEventListener("dragover",function(s){s.preventDefault(),t&&t!==n&&n.classList.add("drop-zone")}),i.addEventListener("dragleave",function(){n.classList.remove("drop-zone")}),i.addEventListener("drop",function(s){if(s.preventDefault(),n.classList.remove("drop-zone"),!t||t===n)return;const l=t.parentNode,u=n.parentNode,c=document.createElement("li"),d=document.createElement("li");c.hidden=!0,d.hidden=!0,l.insertBefore(c,t),u.insertBefore(d,n),l.insertBefore(n,c),u.insertBefore(t,d),l.removeChild(c),u.removeChild(d),P()})}),"ontouchstart"in window&&r.forEach(n=>{const i=n.querySelector(".nav-button");let s=!1;i.addEventListener("touchstart",l=>{s=!1,setTimeout(()=>{s=!0,n.classList.add("dragging")},180)}),i.addEventListener("touchmove",l=>{s&&l.preventDefault()},{passive:!1}),i.addEventListener("touchend",l=>{if(!s)return;n.classList.remove("dragging"),s=!1,l.preventDefault();const u=l.changedTouches[0],d=document.elementFromPoint(u.clientX,u.clientY)?.closest(".nav-list > li:has(.nav-button), .nav-container--expanded .nav-list > li:has(.nav-button)");if(d&&d!==n){const h=n.parentNode,p=d.parentNode,f=document.createElement("li"),y=document.createElement("li");f.hidden=!0,y.hidden=!0,h.insertBefore(f,n),p.insertBefore(y,d),h.insertBefore(d,f),p.insertBefore(n,y),h.removeChild(f),p.removeChild(y),P()}})}),ee();const o=document.querySelector(".nav-container");o&&(o.style.opacity="1")}function P(){const a=document.querySelector(".nav-list"),e=document.querySelector(".nav-container--expanded .nav-list"),t=Array.from(a.children).filter(o=>o.querySelector(".nav-button")).map(o=>o.querySelector(".nav-button").getAttribute("href")),r=Array.from(e.children).map(o=>o.querySelector(".nav-button").getAttribute("href"));localStorage.setItem("navOrder",JSON.stringify({main:t,expanded:r}))}function ee(){const a=JSON.parse(localStorage.getItem("navOrder"));if(!a)return;const e=document.querySelector(".nav-list"),t=document.querySelector(".nav-container--expanded .nav-list"),r=e.lastElementChild,o=new Map;document.querySelectorAll("li").forEach(n=>{const i=n.querySelector(".nav-button");i&&o.set(i.getAttribute("href"),n)}),Array.from(e.children).forEach(n=>{n!==r&&n.remove()}),t.innerHTML="",a.main.forEach(n=>{const i=o.get(n);i&&e.insertBefore(i,r)}),a.expanded.forEach(n=>{const i=o.get(n);i&&t.appendChild(i)})}const v={TABLES:1,CALCULATIONS:1,PULL_PLANS:1,BUTTONS:1};function Le(a,e){if(!a)throw new Error("Persistence factory requires a namespace.");const t={TABLES:`gacha_tables_${a}_v1`,CALCULATIONS:`gacha_calc_${a}_v1`,PULL_PLANS:`gacha_plans_${a}_v1`,BUTTONS:"gacha_buttons_${namespace}_v1"};return{DEBOUNCE_TIME:1500,debug:!1,saveTimeout:null,init(){this.setupTableListeners(),window.addEventListener("beforeunload",()=>this.saveTables())},saveCalculation(r){this._save(t.CALCULATIONS,{_schema:v.CALCULATIONS,...r})},loadCalculation(){return this._validate(this._load(t.CALCULATIONS),"CALCULATIONS")},saveTables(){this._save(t.TABLES,{_schema:v.TABLES,pity:this.getPityData(),constellation:this.getConstellationData(),rateUps:this.getRateUpData()})},loadTables(){return this._validate(this._load(t.TABLES),"TABLES")},saveButtons(){this._save(t.BUTTONS,{_schema:v.BUTTONS,isHidden:this.areButtonsHidden()})},loadButtons(){return this._load(t.BUTTONS)},getPityData(){return Array.from(document.querySelectorAll(`${e.PITY_TABLE} tbody tr`)).map(r=>({banner:r.dataset.banner,...r.querySelector('[data-control="pity-4"]')&&{pity4:r.querySelector('[data-control="pity-4"]').value},...r.querySelector('[data-control="pity-5"]')&&{pity5:r.querySelector('[data-control="pity-5"]').value},...r.querySelector(".guarantee-4")&&{guarantee4:r.querySelector(".guarantee-4").checked},...r.querySelector(".guarantee-5")&&{guarantee5:r.querySelector(".guarantee-5").checked},...r.querySelector('[data-control="capRad"]')&&{caprad:r.querySelector('[data-control="capRad"]').value},...r.querySelector('[data-control="epPath"]')&&{epPath:r.querySelector('[data-control="epPath"]').value}}))},getConstellationData(){return Array.from(document.querySelectorAll(`${e.CONSTELLATION_TABLE} tbody tr`)).map(r=>Array.from(r.querySelectorAll("td:nth-child(n+2) input")).map(o=>o.value))},getRateUpData(){return Array.from(document.querySelectorAll("#rate-up-table select.custom-select")).map(r=>r.value)},areButtonsHidden(){return document.querySelector(".help-btn").classList.contains("hidden")},setupTableListeners(){const r=[`${e.PITY_TABLE} input`,"#rate-up-table select"].join(",");document.querySelectorAll(r).forEach(o=>{o.addEventListener("input",()=>this.queueSave())})},queueSave(){clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>this.saveTables(),this.DEBOUNCE_TIME)},_save(r,o){try{localStorage.setItem(r,JSON.stringify(o))}catch(n){console.error("Storage error:",n),this._handleStorageError()}},_load(r){try{const o=localStorage.getItem(r);return o?JSON.parse(o):null}catch(o){return console.error("Load error:",o),null}},_validate(r,o){return r?typeof r._schema>"u"?r:r._schema!==v[o]?(console.warn(`Schema version mismatch for ${o}`),null):r:null},_handleStorageError(){Object.values(t).forEach(r=>{try{localStorage.removeItem(r)}catch(o){console.error("Cleanup failed:",o)}})}}}function Ce(){document.querySelectorAll(".tab-nav").forEach(e=>{e.addEventListener("click",t=>{if(!t.target.matches(".tab-link[data-tab-target]"))return;const r=t.target,o=r.closest(".tab-panel-card"),n=r.dataset.tabTarget,i=o.querySelector(n);if(!i){console.error(`Tab target not found: ${n}`);return}o.querySelectorAll(".tab-link").forEach(s=>s.classList.remove("active")),o.querySelectorAll(".tab-pane").forEach(s=>s.classList.remove("active")),r.classList.add("active"),i.classList.add("active")})})}class xe{constructor(e){this.tourSteps=[],this.currentTourStepIndex=0,this.isTourActive=!1,this.isShowingHelp=!1,this.pausedTourStepIndex=-1,this.currentHighlightedElement=null,this.observers=null,this.currentDisplayConfig=null,this.boundHandleWindowResize=this.handleReposition.bind(this),this.boundHandleHighlightUpdate=this.handleHighlightUpdate.bind(this),this.container=document.createElement("div"),this.container.id="chibi-container",this.container.innerHTML=`
            <div class="chibi-tutorial-overlay-piece" data-overlay="top"></div>
            <div class="chibi-tutorial-overlay-piece" data-overlay="bottom"></div>
            <div class="chibi-tutorial-overlay-piece" data-overlay="left"></div>
            <div class="chibi-tutorial-overlay-piece" data-overlay="right"></div>
        `,this.container.innerHTML+=e,document.body.appendChild(this.container),this.overlays={top:this.container.querySelector('[data-overlay="top"]'),bottom:this.container.querySelector('[data-overlay="bottom"]'),left:this.container.querySelector('[data-overlay="left"]'),right:this.container.querySelector('[data-overlay="right"]')},this.chibiGroup=this.container.querySelector(".chibi-group"),this.bubbleText=this.container.querySelector(".bubble-text"),this.nextButton=this.container.querySelector(".btn--tutorial_next"),this.endButton=this.container.querySelector(".btn--tutorial_end"),this.handleNext=this.handleNext.bind(this),this.hide=this.hide.bind(this),this.handleReposition=this.handleReposition.bind(this),this.nextButton.addEventListener("click",this.handleNext),this.endButton.addEventListener("click",this.hide)}startTour(e){if(localStorage.setItem("tutorialSeen","true"),!e||e.length===0){console.error("ChibiTutorial: No steps provided for the tour.");return}this.tourSteps=e,this.pausedTourStepIndex===-1?this.currentTourStepIndex=0:(this.currentTourStepIndex=this.pausedTourStepIndex,this.pausedTourStepIndex=-1),this.isTourActive=!0,this.isShowingHelp=!1,this.nextButton.textContent=">>",this.endButton.style.display="inline-block",this.#a(),this.showTourStep(this.currentTourStepIndex)}showTourStep(e){if(e>=this.tourSteps.length){this.hide();return}const t=this.tourSteps[e];this.showDisplay(t)}showTutorialIfNeeded(){if(!localStorage.getItem("tutorialSeen")){const t=document.getElementById("start-tour-btn");t&&(t.classList.add("attention-grabber"),setTimeout(()=>{t.classList.remove("attention-grabber")},1e4))}}showDisplay(e){this.currentDisplayConfig=e,this.#r(),this.chibiGroup.classList.remove("chibi-on-left"),e.chibiSide==="left"&&this.chibiGroup.classList.add("chibi-on-left");const t=this.container.querySelector(".bubble-wrapper");t.classList.remove("bubble-wrapper--big","bubble-wrapper--small");const r=e.size;r&&t.classList.add(`bubble-wrapper--${r}`),this.bubbleText.innerHTML=e.text,this.container.style.display="block",this.container.style.height=`${document.documentElement.scrollHeight}px`;let o=null,n=!1;if(e.clickTab){const i=document.querySelector(e.clickTab);i?(i.dispatchEvent(new Event("click",{bubbles:!0})),n=!0):console.warn(`ChibiTutorial: Tab button not found for selector "${e.clickTab}".`)}if(e.action==="click"){const i=document.querySelector(e.element);i?(i.dispatchEvent(new Event("click",{bubbles:!0})),n=!0):console.error(`ChibiTutorial: Element not found for selector "${e.element}" to perform action "${e.action}".`)}if(e.element){o=document.querySelector(e.element);const i=document.querySelector(".tutorial-chibi");if(this.#e(o),!o){console.error(`ChibiTutorial: Element not found for selector "${e.element}". Skipping display.`),this.isTourActive&&this.handleNext();return}n&&setTimeout(()=>{this.currentHighlightedElement=o,this.currentHighlightedElement.classList.add("chibi-tutorial-focused-element"),this.observers&&this.observers.targetObserver&&this.observers.targetObserver.observe(this.currentHighlightedElement),this.#e(this.currentHighlightedElement)},50);const s=[o,this.chibiGroup,i];this.#n(s)}else this.#e(null),this.chibiGroup.scrollIntoView({behavior:"smooth",block:"nearest"});window.addEventListener("resize",this.boundHandleWindowResize)}#n(e){if(e.length===0)return;const t=this.getCombinedBoundingRect(e),r=document.createElement("div");r.style.cssText=`
        position: absolute;
        top: ${t.top}px;
        height: ${t.height}px;
        pointer-events: none;
        visibility: hidden;
    `,document.body.appendChild(r),r.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>{document.body.removeChild(r)},1e3)}getCombinedBoundingRect(e){const t=e.map(l=>l.getBoundingClientRect()),r=Math.min(...t.map(l=>l.left)),o=Math.min(...t.map(l=>l.top)),n=Math.max(...t.map(l=>l.right)),i=Math.max(...t.map(l=>l.bottom)),s=10;return{top:o+window.pageYOffset-s,left:r+window.pageXOffset-s,width:n-r+s*2,height:i-o+s*2,right:n+window.pageXOffset+s,bottom:i+window.pageYOffset+s}}hide(){this.container.style.display="none",this.chibiGroup.classList.remove("chibi-on-left"),this.#r(),this.#i(),this.currentDisplayConfig=null,this.isShowingHelp||(this.isTourActive=!1,this.currentTourStepIndex=0,this.pausedTourStepIndex=-1),this.isShowingHelp=!1,this.nextButton.textContent="Next",this.endButton.style.display="inline-block",window.removeEventListener("resize",this.boundHandleWindowResize)}#r(){this.currentHighlightedElement&&(this.observers&&this.observers.targetObserver&&this.observers.targetObserver.unobserve(this.currentHighlightedElement),this.currentHighlightedElement.classList.remove("chibi-tutorial-focused-element"),this.currentHighlightedElement=null)}handleNext(){this.isTourActive?(this.currentTourStepIndex++,this.showTourStep(this.currentTourStepIndex)):this.isShowingHelp?(this.hide(),this.pausedTourStepIndex!==-1&&this.startTour(this.tourSteps)):this.hide()}showHelp(e,t=null){if(!e){console.warn("ChibiTutorial: No help configuration provided.");return}let r=null;if(e.tourStepId){const o=this.tourSteps.findIndex(n=>n&&n.id===e.tourStepId);if(o!==-1)r={...this.tourSteps[o]};else if(console.warn(`ChibiTutorial: Tour step with ID '${e.tourStepId}' not found.`),e.text)r={text:e.text,element:e.element,clickTab:e.clickTab,position:e.position||"bottom",chibiSide:e.chibiSide||"right",size:e.size||""};else return}else e.text&&(r={text:e.text,element:e.element,clickTab:e.clickTab,position:e.position||"bottom",chibiSide:e.chibiSide||"right",size:e.size||""});!r.element&&t&&(r.element=t),r&&(this.isTourActive&&(this.pausedTourStepIndex=this.currentTourStepIndex,this.isTourActive=!1),this.isShowingHelp=!0,this.nextButton.textContent="OK",this.endButton.style.display="none",this.showDisplay(r))}handleHighlightUpdate(){window.requestAnimationFrame(()=>{if(!this.currentHighlightedElement||!this.isTourActive&&!this.isShowingHelp)return;this.container.style.height=`${document.documentElement.scrollHeight}px`;const e=this.currentHighlightedElement.getBoundingClientRect(),t={top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX,width:e.width,height:e.height};this.#t(t)})}handleReposition(){window.requestAnimationFrame(()=>{!this.currentHighlightedElement||!this.isTourActive&&!this.isShowingHelp||(this.container.style.height=`${document.documentElement.scrollHeight}px`,this.#e(this.currentHighlightedElement))})}#e(e){if(e===null){const t=window.innerWidth,r=window.innerHeight,o=window.scrollX||window.pageXOffset,n=window.scrollY||window.pageYOffset,i=this.chibiGroup.getBoundingClientRect(),s=i.width,l=i.height,u=o+(t-s)/2,c=n+(r-l)/2;this.chibiGroup.style.left=`${u}px`,this.chibiGroup.style.top=`${c}px`,this.chibiGroup.style.transform="",this.#t(e)}else{this.container.style.height=`${document.documentElement.scrollHeight}px`;const t=e.getBoundingClientRect(),r={top:t.top+window.scrollY,bottom:t.bottom+window.scrollY,left:t.left+window.scrollX,right:t.right+window.scrollX,width:t.width,height:t.height};this.#t(r),this.#o(r)}}#o(e){const t=this.currentDisplayConfig||{},r=document.querySelector(".tutorial-chibi"),o=this.chibiGroup.getBoundingClientRect(),n=r.getBoundingClientRect(),i=[this.chibiGroup,r],s=this.getCombinedBoundingRect(i),l=10;let u;window.innerWidth<900||window.innerWidth<620?t.position==="top"?u="top":u="bottom":u=t.position||"bottom";let c,d;switch(u){case"top":c=e.top-s.height+l,d=e.left+e.width/2-s.width/2;break;case"right":c=e.top+e.height/2-s.height/2+l/2,d=e.right+l;break;case"left":c=e.top+e.height/2-s.height/2+l/2,d=e.left-s.width+l;break;default:c=e.bottom+l,d=e.left+e.width/2-s.width/2;break}n.left<o.left&&(d=d-(n.left-o.left)),n.top<o.top&&(c=c-n.top+o.top),(d+s.width>window.innerWidth||d<l)&&(d=l),this.chibiGroup.style.left=`${d}px`,this.chibiGroup.style.top=`${c}px`,this.chibiGroup.style.transform=""}#t(e){if(!e){this.overlays.top.style.cssText="width: 100%; height: 100%;",this.overlays.bottom.style.cssText="width: 0; height: 0;",this.overlays.left.style.cssText="width: 0; height: 0;",this.overlays.right.style.cssText="width: 0; height: 0;";return}this.overlays.left.style.cssText=`top: 0; left: 0; width: ${e.left}px; height: 100%;`,this.overlays.right.style.cssText=`top: 0; left: ${e.right}px; width: calc(100% - ${e.right}px); height: 100%;`,this.overlays.top.style.cssText=`top: 0; left: ${e.left}px; width: ${e.width}px; height: ${e.top}px;`,this.overlays.bottom.style.cssText=`top: ${e.bottom}px; left: ${e.left}px; width: ${e.width}px; height: calc(100% - ${e.bottom}px);`}#a(){this.observers={targetObserver:new ResizeObserver(this.boundHandleHighlightUpdate),bodyObserver:new ResizeObserver(this.boundHandleHighlightUpdate),mutationObserver:new MutationObserver(this.boundHandleHighlightUpdate)},this.observers.bodyObserver&&this.observers.bodyObserver.observe(document.body),this.observers.mutationObserver&&this.observers.mutationObserver.observe(document.body,{attributes:!0,childList:!0,subtree:!0})}#i(){this.observers&&(this.observers.targetObserver&&this.observers.targetObserver.disconnect(),this.observers.bodyObserver&&this.observers.bodyObserver.disconnect(),this.observers.mutationObserver&&this.observers.mutationObserver.disconnect(),this.observers=null)}showError(e,t=".tab-panel-card"){const r={text:`<p style="color: #ff6b6b;">${e}</p>`,element:t,position:"right",chibiSide:"right",size:"small"};this.showHelp(r)}}const g=(a,e=!1)=>a?e?a.checked:parseInt(a.value)||0:null;function Ae(a,e,t,r){const o=document.getElementById("pity-panel"),n=document.getElementById("constellation-panel"),i=e.paths;if(!o||!n)return console.error("Required tab panels not found. Cannot get page configuration."),null;const s=(m,T)=>{if(!T)return[];const w=T.querySelector("#constellation-table");if(!w)return console.warn("Could not find the constellation table inside the panel:",T),[];const H=w.querySelectorAll(`tr[data-rarity="${m}"] .custom-input`);return Array.from(H).map(k=>parseInt(k.value)||0)},l=o.querySelector(`${t.PITY_ROW}[data-banner="character"]`),u=o.querySelector(`${t.PITY_ROW}[data-banner="weapon"]`),c=te(i),d={},h={},p={},f={},y={};return r.isCharacter&&(d.char=g(l.querySelector('[data-control="pity-5"]')),h.char=g(l.querySelector('[data-control="pity-4"]')),p.char=g(l.querySelector(".guarantee-5"),!0),f.char=g(l.querySelector(".guarantee-4"),!0),r.isCapRad&&(y.capRad=g(l.querySelector('[data-control="capRad"]')))),r.isWeapon&&(d.wep=g(u.querySelector('[data-control="pity-5"]')),h.wep=g(u.querySelector('[data-control="pity-4"]')),p.wep=g(u.querySelector(".guarantee-5"),!0),f.wep=g(u.querySelector(".guarantee-4"),!0),r.isEpitPath&&(y.epitPath=g(u.querySelector('[data-control="epPath"]')))),{SSR:{pity:d,guarantee:p,special:y,consCountStandard:s(5,n),pullPlan:c.typeArray,cashbackRoadmap:c.cashbackArray},SR:{pity:h,guarantee:f,rateUps:re(),consCount:s(4,n)}}}function Pe(){const a=document.querySelectorAll(".row"),e=[];return Array.from(a).slice(1).forEach(r=>{const o=r.dataset.group,n=r.querySelector(".type-selector")?.value||"char",i=r.querySelector(".first-select")?.value||"None",s=r.querySelector(".second-select")?.value||"None";e.push({group:o,type:n,from:i,to:s})}),{pullPlan:e}}function te(a){const e=document.querySelectorAll(".row"),t=[],r=[],o=Array.from(e).slice(1);let n=0;return o.forEach(i=>{const s=i.querySelector(".type-selector")?.value||"char",l=i.querySelector(".first-select")?.value||"None",u=i.querySelector(".second-select")?.value||"None",c=s==="char"?a.char:a.wep,d=c.indexOf(l),h=c.indexOf(u);if(d===-1||h===-1||d>=h)return;const p=h-d;let f=d,y=0;for(let m=0;m<p;m++)s==="char"&&f===0?y="none":y="regular",t.push({type:s,bannerCount:n}),r.push(y),f++;n++}),{typeArray:t,cashbackArray:r}}function Ie(a){const e=document.querySelectorAll(".row"),t=Array.from(e).slice(1);let r=["None"];const o=a.char,n=a.wep;return t.forEach(i=>{const s=i.querySelector(".type-selector")?.value||"char",l=i.querySelector(".first-select")?.value||"None",u=i.querySelector(".second-select")?.value||"None",c=s==="char"?o:n,d=c.indexOf(l),h=c.indexOf(u);if(d===-1||h===-1||d>=h)return;const p=c.slice(d+1,h+1);r.push(...p)}),r}function re(){const a=document.querySelectorAll("#rate-up-table select.custom-select");let e=[];return a.length===0?(console.error("Could not find any rate-up select elements."),[]):(a.forEach(t=>{const r=t.value;r!=="unknown"&&(r!==void 0?e.push(r):console.warn(`Invalid or unhandled rate-up value found: "${r}"`))}),e)}function Oe(){const a=document.querySelector(".mode-label.active").getAttribute("data-target");if(a==="probability")return{type:a,value:parseInt(document.querySelector('[data-control="probability"]').value)/100};if(a==="pulls")return{type:a,value:parseInt(document.querySelector('[data-control="pulls"]').value)}}let b=null;function ne(){const a=document.getElementById("myChart").getContext("2d");b=new Chart(a,{type:"line",data:{labels:[],datasets:[]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#b8c2d0",callback:function(e){return(e*100).toFixed(0)+"%"}},grid:{color:"rgba(58, 58, 106, 0.5)"},beginAtZero:!0,min:0,max:1},x:{ticks:{color:"#b8c2d0"},grid:{color:"rgba(58, 58, 106, 0.5)"}}},plugins:{legend:{labels:{color:"#f5f5f5",sort:(e,t)=>e.datasetIndex-t.datasetIndex}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(e){let t=e.dataset.label||"";return t&&(t+=": "),t+=(e.parsed.y*100).toFixed(2)+"%",t}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}}})}function oe(a){const e=["#FF9800","#9C27B0","#E91E63","#00BCD4"];return e[a%e.length]}function ae(a){const e=["rgba(255, 99, 132, 0.1)","rgba(255, 159, 64, 0.1)","rgba(255, 205, 86, 0.1)","rgba(75, 192, 192, 0.1)","rgba(153, 102, 255, 0.1)"];return e[(a-2)%e.length]}function Be(a,e,t){b||ne();const r=a.length,o=t.slice(1);b.data.labels=e,b.data.datasets=a.map((n,i)=>{const s=i===0?"#2196F3":i===1?"#4CAF50":oe(i);return{label:o[i],data:n,borderColor:s,backgroundColor:i===0?"rgba(33, 150, 243, 0.1)":i===1?"rgba(76, 175, 80, 0.1)":ae(i),fill:!0,tension:.4,order:r-i,borderWidth:3,pointRadius:0,pointHoverRadius:5}}),b.update()}function Ne(a){let e=a[0].length,t=Array.from({length:e-1},()=>Array.from({length:a.length+1},()=>0)),r=[0];for(let o=0;o<a.length;o++){let n=0;for(const c of a[o])n+=c;let i=0;const s=o+1;r.push(s);const l=a[o],u=l.length-1;for(let c=u;c>0;c--)i+=l[c],t[c-1][s]=i/n}return{data:t,labels:r}}function Re(a){document.querySelector(".mode-label.active").getAttribute("data-target")==="probability"?document.querySelector('.input-lock-container input[data-control="pulls"]').value=ie(a,parseInt(document.querySelector('[data-control="probability"]').value)):document.querySelector('.input-lock-container input[data-control="probability"]').value=se(a,parseInt(document.querySelector('[data-control="pulls"]').value))}function ie(a,e){e===100&&(e=99.9);let t=a.length-1,r=!0,o=0,n=0;for(;r;)a[t][n]>e/100&&(o=n,r=!1),n++;return o}function se(a,e){let t=a.length-1;return a[t].length<=e?100:Math.round(a[t][e]*100)}export{ge as B,xe as C,be as D,q as I,W as O,S,ye as U,Ne as a,Pe as b,Le as c,Ie as d,Ae as e,Ce as f,Oe as g,ve as h,le as i,ce as j,Se as k,Te as l,we as m,ue as n,de as o,Ee as p,fe as q,Re as r,qe as s,pe as t,Be as u,me as v,he as w};
