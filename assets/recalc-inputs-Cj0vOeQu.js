(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();function le(a,e,r,t,o,n){H(e.pity,t,n),k(e,t,n),U(o);const i=a.loadTables();i&&(P(i.pity,n),I(i.constellation,n),M(i.rateUps),r.validateAll()),a.init()}function ce(a){const e=a.loadButtons();e&&e.isHidden&&z()}function H(a,e,r){const t=document.getElementById("pity-row-template"),o=document.querySelector(`${r.PITY_TABLE} tbody`);Object.entries(e.pitySettings).forEach(([n,i])=>{const s=t.content.cloneNode(!0).querySelector("tr"),l=s.querySelector(".special-mechanic");s.dataset.validationType="individual";const u=s.querySelector('[data-control="pity-4"]'),c=s.querySelector('[data-control="pity-5"]');if(u&&(u.min=0,u.max=n.includes("weapon")?a.pitySRWep-1:a.pitySRChar-1),c&&(c.min=0,c.max=n.includes("weapon")?a.pitySSRWep-1:a.pitySSRChar-1),s.dataset.banner=n,s.querySelector(".banner-name").textContent=n,s.querySelector('[data-control="pity-4"]').value=i.pity4,s.querySelector('[data-control="pity-5"]').value=i.pity5,l){let h="";n==="character"?h=`<div class="button-container">
            <input type="number" data-control="capRad" class="custom-input" min="0" max="3" 
                   value="${i.caprad??0}">
                            <button class="help-btn" data-help-key="caprad-help"
                                aria-label="Help for Importing Pity Data">
                                ?
                            </button>
                        </div>`:n==="weapon"&&(h=`<div class="button-container">
            <input type="number" data-control="epPath" class="custom-input" min="0" max="1" 
                   value="${i.epPath??0}">
                            <button class="help-btn" data-help-key="eppath-help"
                                aria-label="Help for Importing Pity Data">
                                ?
                            </button>
                        </div>`),l.innerHTML=h}o.appendChild(s);const d=document.querySelector("#pity-table");d&&d.querySelectorAll('tbody tr input[type="number"]').forEach(h=>h.addEventListener("input",function(){let p=this.value;p.length>1&&p.startsWith("0")&&(this.value=p.replace(/^0+/,"")),this.value===""&&(this.value="0");let f=parseInt(this.value)||0;f>h.max?(this.value=h.max,E(this)):f<h.min&&(this.value=h.min,E(this))}))})}function k(a,e,r){const t=document.getElementById("const-column-template"),o=document.querySelectorAll(`${r.CONSTELLATION_TABLE} tbody tr`),n=a.poolStandardCharSSR,i=a.poolCharSR;o.forEach(s=>{const l=document.createDocumentFragment(),u=s.dataset.rarity;s.dataset.validationType="row-sum",s.dataset.targetSum=u==="5"?n:i;for(let c=0;c<e.constellationColumns;c++){const d=t.content.cloneNode(!0),h=d.querySelector("input");if(c===0){const p=u==="5"?n:i;h.value=p}h.addEventListener("input",()=>L(s)),h.addEventListener("input",function(){h.value.length>1&&h.value.startsWith("0")&&(h.value=h.value.replace(/^0+/,"")),h.value===""&&(h.value="0")}),l.appendChild(d)}s.appendChild(l),D(s),L(s)})}function D(a){const e=document.createElement("div");e.className="row-progress-bar",a.appendChild(e)}function L(a){const e=a.querySelectorAll("input"),r=parseInt(a.dataset.targetSum);let t=0;e.forEach(i=>{t+=parseInt(i.value)||0});const o=a.querySelector(".row-progress-bar"),n=Math.min(t/r*100,100);o.style.width=n+"%",n<60||t>r?o.style.background="rgba(244, 67, 54, 0.3)":n<80?o.style.background="rgba(241, 244, 54, 0.3)":o.style.background="rgba(54, 244, 79, 0.3)"}function U(a){const e=document.querySelectorAll("#rate-up-table select");if(e.length===0)return;const r=a.map(t=>`<option value="${t.value}">${t.text}</option>`).join("");e.forEach(t=>{t.innerHTML=r,t.value="unknown"})}function ue(a,e=null){const r=document.querySelector('[data-control="probability"]'),t=document.querySelector('[data-control="pulls"]');e?(r.value=e.targetProb||a.probability,t.value=e.targetPull||a.pulls):(r.value=a.probability,t.value=a.pulls),r.addEventListener("input",function(){let o=this.value;o.length>1&&o.startsWith("0")&&(this.value=o.replace(/^0+/,"")),this.value===""&&(this.value="0");let n=parseInt(this.value)||0;n>100?(this.value="100",E(this)):n===0&&(this.value="0")}),t.addEventListener("input",function(){let o=this.value;o.length>1&&o.startsWith("0")&&(this.value=o.replace(/^0+/,"")),this.value===""&&(this.value="0");let n=parseInt(this.value)||0;n>9999?this.value="9999":n<1&&(this.value="1")})}function E(a){a.style.borderColor="#a71919",a.style.outline="1px solid #a71919",a.classList.add("flicker"),setTimeout(()=>{a.classList.remove("flicker"),a.style.borderColor="",a.style.outline=""},500)}function de(a,e,r){const t=[];for(let n=0;n<a.length;n++){let i=0;for(const[s,l]of a[n].offRates)i+=l.prob;i=(i*100).toFixed(2),i>0&&t.push({name:e[n],probability:i,p10:r[n].LOWER_BOUND,mean:r[n].MEAN,p90:r[n].UPPER_BOUND,color:"#3498db"})}const o=document.querySelector("#probability-table tbody");o.innerHTML="",t.forEach(n=>{const i=document.createElement("tr"),s=n.probability;i.innerHTML=`
      <td>${n.name}</td>
      <td>
        <div class="progress-container">
          <div class="progress-bar" style="width:${s}%;background:${n.color}">
            <div class="progress-label">${n.probability}%</div>
          </div>
        </div>
      </td>
      <td class="cashback-value">${n.p10.toFixed(1)}</td>
      <td class="cashback-value highlight">${n.mean.toFixed(1)}</td>
      <td class="cashback-value">${n.p90.toFixed(1)}</td>
    `,o.appendChild(i)})}function P(a,e){a.forEach(r=>{const t=document.querySelector(`${e.PITY_TABLE} tr[data-banner="${r.banner}"]`);t&&(t.querySelector('[data-control="pity-4"]').value=r.pity4,t.querySelector('[data-control="pity-5"]').value=r.pity5,t.querySelector(".guarantee-4").checked=r.guarantee4,t.querySelector(".guarantee-5").checked=r.guarantee5,r.caprad&&t.querySelector('[data-control="capRad"]')&&(t.querySelector('[data-control="capRad"]').value=r.caprad),r.epPath&&t.querySelector('[data-control="epPath"]')&&(t.querySelector('[data-control="epPath"]').value=r.epPath))})}function I(a,e){document.querySelectorAll(`${e.CONSTELLATION_TABLE} tbody tr`).forEach((t,o)=>{const n=a[o];n&&t.querySelectorAll("td:nth-child(n+2) input").forEach((s,l)=>{n[l]!==void 0&&(s.value=n[l])})})}function M(a){if(!a||!Array.isArray(a))return;document.querySelectorAll("#rate-up-table select.custom-select").forEach((r,t)=>{a[t]!==void 0&&(r.value=a[t])})}function z(){document.querySelectorAll(".help-btn").forEach(e=>{e.classList.toggle("hidden")})}const G=[.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.015,.04,.065,.09,.115,.14,.165,.19,.215,.24,1],he=.085,pe={maxCharacterConstelation:5,rateUpCharacterSR:2,poolStandardCharSSR:40,poolCharSR:23,configSR:{maxType:6,regularPoints:.3,specialPoints:.7},configSSR:{maxType:6,regularPoints:1.2,specialPoints:2.8},paths:{char:["None","p0","p1","p2","p3","p4","p5"]},pity:{pitySSR:G.length,pitySR:10},default:0},W=[{value:"unknown",text:"Unknown"},{value:"none",text:"Not Owned"},{value:"p0",text:"P0"},{value:"p1",text:"P1"},{value:"p2",text:"P2"},{value:"p3",text:"P3"},{value:"p4",text:"P4"},{value:"p5",text:"P5"},{value:"new",text:"New Character"}],fe={none:0,p0:1,p1:2,p2:3,p3:4,p4:5,p5:6},ye=["1.0","1.1","1.2","1.3","1.4","1.5","1.6","1.7","1.8","1.9","2.0","2.1","2.2","2.3","2.4","2.5","2.6","2.7","AC","2.8","3.0","3.1","3.2","3.3"],ge={"One Gram of Curiosity":{char:"Sotheby",release:"1.0"},"Clang of Sword & Armor":{char:"A Knight",release:"1.0"},"Pop is Everything":{char:"Melania",release:"1.1"},"Thus Spoke The Border Collie":{char:"Pickles",release:"1.1"},"The Fairies Shining at Night":{char:"Tooth Fairy",release:"1.2"},"The Changeling Awaits":{char:"Jessica",release:"1.2"},"That Steady Evening Star":{char:"Kaalaa Baunaa",release:"1.3"},"Another Spring Thaw":{char:"Shamane",release:"1.3"},"Beyond the World of Matters":{char:"37",release:"1.4"},"Seeker in the Cave":{char:"6",release:"1.4"},"The Chirps of Flame":{char:"Spathodea",release:"1.5"},"The Spores of Peace":{char:"Ezra Theodore",release:"1.5"},"Over the New Leaf":{char:"Getian",release:"1.6"},"Vissi D'arte, Vissi D'amore":{char:"Isolde",release:"1.7"},"Reading in Sea Breeze":{char:"Marcus",release:"1.7"},"Ode to the Utopia":{char:"Vila",release:"1.8"},"The Intersecting Lines":{char:"Windsong",release:"1.8"},"Into the Mirrors":{char:"Kakania",release:"1.9"},"Calming Hues in Frenzied Nights":{char:"Mercuria",release:"2.0"},"Clash n' Slash":{char:"J",release:"2.0"},"Blue Lullaby":{char:"Tuesday",release:"2.1"},"Shooting in the Dark":{char:"Argus",release:"2.1"},"Fledgling's First Flight":{char:"Lopera",release:"2.2"},"When the Swan Dances":{char:"Willow",release:"2.3"},"The Book of Whys":{char:"Flutterpage",release:"2.3"},"Playing in Rainbow Clef":{char:"Barcarola",release:"2.4"},"A Shell on the Waves":{char:"Fatutu",release:"2.4"},"A Life in Montage":{char:"Noire",release:"2.5"},"A Writing Writer Written":{char:"Recoleta",release:"2.6"},"The Shattered Product":{char:"Aleph",release:"2.6"},"Serpentine Century":{char:"Hissabeth",release:"2.7"},"Wirewalking in Zero Gravity":{char:"Kiperina",release:"2.7"},"From the Ruin of the Past":{char:"Moldir",release:"2.8"},"A Beating Heart Beneath the Stone":{char:"Sentinel",release:"3.0"},"The Mourner's Eulogy":{char:"Charon",release:"3.0"},"The Midnight Flutist":{char:"Rubuska",release:"3.1"},"The Land's Iron Stitch":{char:"Corvus",release:"3.1"},"On Fate's Cue":{char:"Beryl",release:"3.2"},"The Brilliace Within":{char:"Brume",release:"3.2"}},F={CHARACTER:"character"},S={PITY_ROW:"[data-banner]",CONSTELLATION_ROW:"[data-rarity]",PITY_TABLE:"#pity-table",CONSTELLATION_TABLE:"#constellation-table"},O={pitySettings:{[F.CHARACTER]:{pity4:0,pity5:0}},isCharacter:!0,isWeapon:!1,isSpecial:!1,constellationColumns:7},be={probability:70,pulls:76};function me(a,e,r){Y(e.pity),V(e),K();const t=a.loadTables();t&&(B(t.pity),N(t.constellation),X(t.rateUps),r.validateAll()),a.init()}function Y(a){const e=document.getElementById("pity-row-template"),r=document.querySelector(`${S.PITY_TABLE} tbody`);Object.entries(O.pitySettings).forEach(([o,n])=>{const i=e.content.cloneNode(!0).querySelector("tr");i.dataset.validationType="individual";const s=i.querySelector('[data-control="pity-5"]');s&&(s.min=0,s.max=a.pitySSR-1),i.dataset.banner=o,i.querySelector(".banner-name").textContent=o,i.querySelector('[data-control="pity-5"]').value=n.pity5,r.appendChild(i)});const t=document.querySelector("#pity-table");t&&t.querySelectorAll('tbody tr input[type="number"]').forEach(o=>o.addEventListener("input",function(){let n=this.value;n.length>1&&n.startsWith("0")&&(this.value=n.replace(/^0+/,""),this.value===""&&(this.value="0"));let i=parseInt(this.value)||0;i>o.max?(this.value=o.max,q(this)):i<=o.min&&(this.value=o.min,q(this))}))}function q(a){a.style.borderColor="#a71919",a.style.outline="1px solid #a71919",a.classList.add("flicker"),setTimeout(()=>{a.classList.remove("flicker"),a.style.borderColor="",a.style.outline=""},500)}function V(a){const e=document.getElementById("const-column-template"),r=document.querySelectorAll(`${S.CONSTELLATION_TABLE} tbody tr`),t=a.poolStandardCharSSR,o=a.poolCharSR;r.forEach(n=>{const i=document.createDocumentFragment(),s=n.dataset.rarity;n.dataset.validationType="row-sum",n.dataset.targetSum=s==="5"?t:o;for(let l=0;l<O.constellationColumns;l++){const u=e.content.cloneNode(!0),c=u.querySelector("input");if(l===0){const d=s==="5"?t:o;c.value=d}c.addEventListener("input",()=>C(n)),c.addEventListener("input",function(){c.value.length>1&&c.value.startsWith("0")&&(c.value=c.value.replace(/^0+/,"")),c.value===""&&(c.value="0")}),i.appendChild(u)}n.appendChild(i),j(n),C(n)})}function j(a){const e=document.createElement("div");e.className="row-progress-bar",a.appendChild(e)}function C(a){const e=a.querySelectorAll("input"),r=parseInt(a.dataset.targetSum);let t=0;e.forEach(i=>{t+=parseInt(i.value)||0});const o=a.querySelector(".row-progress-bar"),n=Math.min(t/r*100,100);o.style.width=n+"%",n<60||t>r?o.style.background="rgba(244, 67, 54, 0.3)":n<80?o.style.background="rgba(241, 244, 54, 0.3)":o.style.background="rgba(54, 244, 79, 0.3)"}function K(){const a=document.querySelectorAll("#rate-up-table select");if(a.length===0)return;const e=W.map(r=>`<option value="${r.value}">${r.text}</option>`).join("");a.forEach(r=>{r.innerHTML=e,r.value="unknown"})}function B(a){a.forEach(e=>{const r=document.querySelector(`${S.PITY_TABLE} tr[data-banner="${e.banner}"]`);r&&(r.querySelector('[data-control="pity-5"]').value=e.pity5,r.querySelector(".guarantee-5").checked=e.guarantee5)})}function N(a){document.querySelectorAll(`${S.CONSTELLATION_TABLE} tbody tr`).forEach((r,t)=>{const o=a[t];o&&r.querySelectorAll("td:nth-child(n+2) input").forEach((i,s)=>{o[s]!==void 0&&(i.value=o[s])})})}function X(a){if(!a||!Array.isArray(a))return;document.querySelectorAll("#rate-up-table select.custom-select").forEach((r,t)=>{a[t]!==void 0&&(r.value=a[t])})}function ve(a,e,r,t,o){const n=document.getElementById("import-file-input");if(!n){console.error("Import file input not found!");return}const i=s=>J(s,a,e,r,t,o);n.removeEventListener("change",n.__handleFile),n.addEventListener("change",i),n.__handleFile=i}async function J(a,e,r,t,o,n){const i=a.target.files[0];if(i)try{let s,l=null;const u=await i.text();i.type==="application/json"?(s=JSON.parse(u),s.exportFormat==="GachaCalculatorData"?l=s:r&&(l=r(s))):i.type==="text/csv"?l=r(u,e):alert("Error: Invalid or unsupported file format."),l&&(Q(l,o),t.validateAll(),e.saveTables())}catch(s){n.showError("Something's wrong with the file you tried to use"),console.error("File import error:",s)}finally{a.target.value=""}}function Q(a,e){a.game==="reverse"?(a.pity&&B(a.pity),a.constellation&&N(a.constellation)):(a.pity&&P(a.pity,e),a.constellation&&I(a.constellation,e))}function Se(a){const e={exportFormat:"GachaCalculatorData",version:"1.0",exportedAt:new Date().toISOString(),pity:a.getPityData(),constellation:a.getConstellationData()},r=JSON.stringify(e,null,2),t=new Blob([r],{type:"application/json"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o;const i=new Date().toISOString().slice(0,10);n.download=`gachaCalc-data-${i}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o),console.log("Data exported successfully.")}function Te(a,e=null){const r=new R(a,e);return r.initialize(),r}function Ee(a,e=null){return new Z(a,e).initialize()}class R{constructor(e,r=null){this.pathsConfig=e,this.savedData=r,this.groupColorMap=new Map,this.rowsContainer=document.querySelector(".rows-container"),this.addButton=document.getElementById("add-btn"),this.COLORS={UNIQUE_GROUP:"#f0f0f0",PRESET_HUES:[0,120,240,60,180,300]}}initialize(){this.rowsContainer.innerHTML="",this.savedData&&this.savedData.pullPlan?this.savedData.pullPlan.forEach(e=>{this.rowsContainer.appendChild(this.createRow(null,e))}):this.rowsContainer.appendChild(this.createRow()),this.addButton.addEventListener("click",()=>{this.rowsContainer.appendChild(this.createRow())})}createRow(e=null,r=null){const t=this.createRowElement();return this.setupRowEvents(t),this.initializeRowData(t,e,r),t}createRowElement(){return document.getElementById("row-template").content.cloneNode(!0).querySelector(".row")}setupRowEvents(e){const r=e.querySelector(".dropdown"),t=e.querySelector(".type-selector");r&&this.setupDropdownHandler(e,r,t),this.setupTypeChangeHandler(e,t),this.setupGoalChangeChecker(e),this.setupButtonHandlers(e)}setupDropdownHandler(e,r,t){r.addEventListener("click",o=>{o.stopPropagation(),r.classList.toggle("dropdown--open")}),e.querySelectorAll(".dropdown__item").forEach(o=>{o.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),t.value=o.dataset.value,t.dispatchEvent(new Event("change")),r.classList.remove("dropdown--open")})}),document.addEventListener("click",o=>{r.contains(o.target)||r.classList.remove("dropdown--open")})}setupTypeChangeHandler(e,r){r.addEventListener("change",()=>{const t=r.options[r.selectedIndex],o=e.querySelector(".type-icon"),n=e.querySelector(".type-text");o.src=t.dataset.icon,n.textContent=t.textContent,this.updatePathSelector(e,r.value),this.handleTypeChangeGroupUpdate(e,r.value)})}setupGoalChangeChecker(e){const r=e.querySelector(".first-select"),t=e.querySelector(".second-select");r.addEventListener("change",()=>{const o=[];for(let u of r)o.push(u.value);o.push(t[t.length-1].value);const n=r.value,i=t.value,s=o.indexOf(n),l=o.indexOf(i);s>=l&&(t.value=o[s+1])}),t.addEventListener("change",()=>{const o=[];for(let u of r)o.push(u.value);o.push(t[t.length-1].value);const n=r.value,i=t.value,s=o.indexOf(n),l=o.indexOf(i);s>=l&&(r.value=o[l-1])})}handleTypeChangeGroupUpdate(e,r){const t=e.dataset.group;t&&!t.startsWith("unique")&&(e.dataset.group=`unique${r.charAt(0).toUpperCase()+r.slice(1)}`,e.style.setProperty("--group-color",this.COLORS.UNIQUE_GROUP))}setupButtonHandlers(e){const r=e.querySelector(".btn--chainAdd");r&&r.addEventListener("click",()=>{this.rowsContainer.appendChild(this.createRow(e))}),e.querySelector(".btn--delete").addEventListener("click",()=>{this.handleRowDeletion(e)})}handleRowDeletion(e){const r=e.dataset.group;r&&!r.startsWith("unique")&&Array.from(this.rowsContainer.querySelectorAll(".row")).filter(o=>o.dataset.group===r).length===1&&this.groupColorMap.delete(r),e.remove()}initializeRowData(e,r,t){t?this.initializeFromSavedData(e,t):r?this.initializeFromParent(e,r):this.initializeNewRow(e)}initializeFromSavedData(e,r){const t=e.querySelector(".type-selector");t.value=r.type||"char",this.updateVisualType(e,t.value),this.setGroupAndColor(e,r.group),this.updatePathSelector(e,t.value,r.from,r.to)}initializeFromParent(e,r){const t=r.dataset.group,o=r.querySelector(".type-selector").value,n=r.querySelector(".second-select").value,i=e.querySelector(".type-selector");i.value=o,this.updateVisualType(e,o),t.startsWith("unique")?this.convertToNewGroup(r,e):this.inheritExistingGroup(e,t),this.updatePathSelector(e,o,n)}convertToNewGroup(e,r){const t=this.generateNewGroupId(),o=this.getHueForGroup(t);[e,r].forEach(n=>{n.dataset.group=t,n.style.setProperty("--group-color",`hsl(${o}, 80%, 70%)`)}),this.groupColorMap.set(t,o)}inheritExistingGroup(e,r){e.dataset.group=r;const t=this.groupColorMap.get(r);t!==void 0&&e.style.setProperty("--group-color",`hsl(${t}, 80%, 70%)`)}initializeNewRow(e){const t=e.querySelector(".type-selector").value;e.dataset.group=`unique${t.charAt(0).toUpperCase()+t.slice(1)}`,e.style.setProperty("--group-color",this.COLORS.UNIQUE_GROUP),this.updatePathSelector(e,t)}updateVisualType(e,r){const t=e.querySelector(".type-selector"),o=t.options[t.selectedIndex],n=e.querySelector(".type-icon"),i=e.querySelector(".type-text");n&&(n.src=o.dataset.icon),i&&(i.textContent=o.textContent)}updatePathSelector(e,r,t=null,o=null){const n=e.querySelector(".first-select"),i=e.querySelector(".second-select"),s=this.pathsConfig[r]||this.pathsConfig.char;this.populateSelect(n,s.slice(0,-1)),this.populateSelect(i,s.slice(1)),this.setInitialPathValues(n,i,s,t,o)}populateSelect(e,r){e.innerHTML="",r.forEach(t=>{const o=document.createElement("option");o.value=t,o.textContent=t,e.appendChild(o)})}setInitialPathValues(e,r,t,o,n){if(o&&t.includes(o)){e.value=o;const i=t.indexOf(o);r.value=n&&t.includes(n)&&t.indexOf(n)>i?n:t[Math.min(i+1,t.length-1)]}else e.value=t[0],r.value=t[1]}generateNewGroupId(){const e=Array.from(this.groupColorMap.keys()).map(r=>parseInt(r.replace(/\D/g,""))).filter(r=>!isNaN(r)).sort((r,t)=>r-t);for(let r=1;r<=e.length+1;r++)if(!e.includes(r))return`group${r}`;return`group${e.length+1}`}getHueForGroup(e){const r=parseInt(e.replace(/\D/g,""));return r<=this.COLORS.PRESET_HUES.length?this.COLORS.PRESET_HUES[r-1]:r*137.5%360}setGroupAndColor(e,r){if(e.dataset.group=r,r.startsWith("unique"))e.style.setProperty("--group-color",this.COLORS.UNIQUE_GROUP);else{let t=this.groupColorMap.get(r);t===void 0&&(parseInt(r.replace(/\D/g,"")),t=this.getHueForGroup(r),this.groupColorMap.set(r,t)),e.style.setProperty("--group-color",`hsl(${t}, 80%, 70%)`)}}getState(){return Array.from(this.rowsContainer.querySelectorAll(".row")).map(r=>({type:r.querySelector(".type-selector").value,from:r.querySelector(".first-select").value,to:r.querySelector(".second-select").value,group:r.dataset.group}))}}class Z extends R{constructor(e,r=null){super(e,r||null)}initialize(){return this.rowsContainer.innerHTML="",this.savedData&&this.savedData.pullPlan?this.savedData.pullPlan.forEach((e,r)=>{const t={...e,pity:this.savedData.pity4?.[r]||0,guarantee:this.savedData.guarantee4?.[r]||!1};this.rowsContainer.appendChild(this.createRow(null,t))}):this.rowsContainer.appendChild(this.createRow()),this.addButton.addEventListener("click",()=>{this.rowsContainer.appendChild(this.createRow())}),this}createRow(e=null,r=null){const t=super.createRow(e,r);return this.addPityGuaranteeToRow(t,r),t}addPityGuaranteeToRow(e,r){const t=e.querySelector('[data-control="pity-4"]'),o=e.querySelector(".guarantee-4");t!==null&&(r&&(t&&r.pity!==void 0&&(t.value=r.pity),o&&r.guarantee!==void 0&&(o.checked=r.guarantee)),t.addEventListener("input",function(){let n=this.value;n.length>1&&n.startsWith("0")&&(this.value=n.replace(/^0+/,""),this.value===""&&(this.value="0"));let i=parseInt(this.value)||0;i>10?(this.value=10,A(this)):i<0&&(this.value=0,A(this))}),t.addEventListener("focus",()=>{t.select()}),t.addEventListener("keydown",n=>{["Backspace","Delete","Tab","Escape","Enter","ArrowLeft","ArrowRight","Home","End"].includes(n.key)||(n.ctrlKey||n.metaKey)&&["a","c","v","x"].includes(n.key.toLowerCase())||/^\d$/.test(n.key)||n.preventDefault()}),t.addEventListener("paste",n=>{const i=(n.clipboardData||window.clipboardData).getData("text");/^\d+$/.test(i)||n.preventDefault()}),t.addEventListener("drop",n=>{n.preventDefault()}))}}function A(a){a.style.borderColor="#a71919",a.style.outline="1px solid #a71919",a.classList.add("flicker"),setTimeout(()=>{a.classList.remove("flicker"),a.style.borderColor="",a.style.outline=""},500)}function we(a=null){const e=document.querySelector('[data-control="probability"]'),r=document.querySelector('[data-control="pulls"]'),t=document.querySelectorAll(".mode-label");let o;a?o=a:o="probability",n(),t.forEach(i=>{i.addEventListener("click",function(){o=this.getAttribute("data-target"),n()})}),e.addEventListener("input",function(){o="probability",n()}),r.addEventListener("input",function(){o="pulls",n()});function n(){t.forEach(i=>{const s=i.getAttribute("data-target")===o;i.classList.toggle("active",s)})}}function Le(){const a=document.getElementById("expand-button"),e=document.getElementById("expandedMenu");let r=null;a&&a.addEventListener("click",()=>{a.classList.toggle("dropdown--open"),e.classList.toggle("active")});const t=document.querySelectorAll(".nav-list > li:has(.nav-button)");t.forEach(n=>{const i=n.querySelector(".nav-button");i.addEventListener("dragstart",function(s){r=n;const l=n.getBoundingClientRect(),u=s.clientX-l.left,c=s.clientY-l.top;s.dataTransfer.setDragImage(n,u,c),n.classList.add("dragging")}),i.addEventListener("dragend",function(){n.classList.remove("dragging"),r=null,document.querySelectorAll(".drop-zone").forEach(s=>s.classList.remove("drop-zone"))}),i.addEventListener("dragover",function(s){s.preventDefault(),r&&r!==n&&n.classList.add("drop-zone")}),i.addEventListener("dragleave",function(){n.classList.remove("drop-zone")}),i.addEventListener("drop",function(s){if(s.preventDefault(),n.classList.remove("drop-zone"),!r||r===n)return;const l=r.parentNode,u=n.parentNode,c=document.createElement("li"),d=document.createElement("li");c.hidden=!0,d.hidden=!0,l.insertBefore(c,r),u.insertBefore(d,n),l.insertBefore(n,c),u.insertBefore(r,d),l.removeChild(c),u.removeChild(d),x()})}),"ontouchstart"in window&&t.forEach(n=>{const i=n.querySelector(".nav-button");let s=!1;i.addEventListener("touchstart",l=>{s=!1,setTimeout(()=>{s=!0,n.classList.add("dragging")},180)}),i.addEventListener("touchmove",l=>{s&&l.preventDefault()},{passive:!1}),i.addEventListener("touchend",l=>{if(!s)return;n.classList.remove("dragging"),s=!1,l.preventDefault();const u=l.changedTouches[0],d=document.elementFromPoint(u.clientX,u.clientY)?.closest(".nav-list > li:has(.nav-button), .nav-container--expanded .nav-list > li:has(.nav-button)");if(d&&d!==n){const h=n.parentNode,p=d.parentNode,f=document.createElement("li"),y=document.createElement("li");f.hidden=!0,y.hidden=!0,h.insertBefore(f,n),p.insertBefore(y,d),h.insertBefore(d,f),p.insertBefore(n,y),h.removeChild(f),p.removeChild(y),x()}})}),ee();const o=document.querySelector(".nav-container");o&&(o.style.opacity="1")}function x(){const a=document.querySelector(".nav-list"),e=document.querySelector(".nav-container--expanded .nav-list"),r=Array.from(a.children).filter(o=>o.querySelector(".nav-button")).map(o=>o.querySelector(".nav-button").getAttribute("href")),t=Array.from(e.children).map(o=>o.querySelector(".nav-button").getAttribute("href"));localStorage.setItem("navOrder",JSON.stringify({main:r,expanded:t}))}function ee(){const a=JSON.parse(localStorage.getItem("navOrder"));if(!a)return;const e=document.querySelector(".nav-list"),r=document.querySelector(".nav-container--expanded .nav-list"),t=e.lastElementChild,o=new Map;document.querySelectorAll("li").forEach(n=>{const i=n.querySelector(".nav-button");i&&o.set(i.getAttribute("href"),n)}),Array.from(e.children).forEach(n=>{n!==t&&n.remove()}),r.innerHTML="",a.main.forEach(n=>{const i=o.get(n);i&&e.insertBefore(i,t)}),a.expanded.forEach(n=>{const i=o.get(n);i&&r.appendChild(i)})}const b={TABLES:1,CALCULATIONS:1,PULL_PLANS:1,BUTTONS:1};function qe(a,e){if(!a)throw new Error("Persistence factory requires a namespace.");const r={TABLES:`gacha_tables_${a}_v1`,CALCULATIONS:`gacha_calc_${a}_v1`,PULL_PLANS:`gacha_plans_${a}_v1`,BUTTONS:`gacha_buttons_${a}_v1`,PAGE_TYPE:`gacha_page_type_${a}_v1`};return{DEBOUNCE_TIME:1500,debug:!1,saveTimeout:null,init(t){this.setupTableListeners(t),this._beforeUnloadHandler&&window.removeEventListener("beforeunload",this._beforeUnloadHandler),this._beforeUnloadHandler=()=>this.saveTables(t),window.addEventListener("beforeunload",this._beforeUnloadHandler)},saveCalculation(t,o=""){const n=o?`${r.CALCULATIONS}_${o}`:r.CALCULATIONS;this._save(n,{_schema:b.CALCULATIONS,...t})},loadCalculation(t=""){const o=t?`${r.CALCULATIONS}_${t}`:r.CALCULATIONS;return this._validate(this._load(o),"CALCULATIONS")},saveTables(t=""){const o=t?`${r.TABLES}_${t}`:r.TABLES;this._save(o,{_schema:b.TABLES,pity:this.getPityData(),constellation:this.getConstellationData(),rateUps:this.getRateUpData()})},loadTables(t=""){const o=t?`${r.TABLES}_${t}`:r.TABLES;return this._validate(this._load(o),"TABLES")},saveButtons(){this._save(r.BUTTONS,{_schema:b.BUTTONS,isHidden:this.areButtonsHidden()})},loadButtons(){return this._load(r.BUTTONS)},savePageType(t){this._save(r.PAGE_TYPE,{_schema:b.PAGE_TYPE,type:t})},loadPageType(){return this._load(r.PAGE_TYPE)},getPityData(){return Array.from(document.querySelectorAll(`${e.PITY_TABLE} tbody tr`)).map(t=>({banner:t.dataset.banner,...t.querySelector('[data-control="pity-4"]')&&{pity4:t.querySelector('[data-control="pity-4"]').value},...t.querySelector('[data-control="pity-5"]')&&{pity5:t.querySelector('[data-control="pity-5"]').value},...t.querySelector(".guarantee-4")&&{guarantee4:t.querySelector(".guarantee-4").checked},...t.querySelector(".guarantee-5")&&{guarantee5:t.querySelector(".guarantee-5").checked},...t.querySelector('[data-control="capRad"]')&&{caprad:t.querySelector('[data-control="capRad"]').value},...t.querySelector('[data-control="epPath"]')&&{epPath:t.querySelector('[data-control="epPath"]').value}}))},getConstellationData(){return Array.from(document.querySelectorAll(`${e.CONSTELLATION_TABLE} tbody tr`)).map(t=>Array.from(t.querySelectorAll("td:nth-child(n+2) input")).map(o=>o.value))},getRateUpData(){return Array.from(document.querySelectorAll("#rate-up-table select.custom-select")).map(t=>t.value)},areButtonsHidden(){return document.querySelector(".help-btn").classList.contains("hidden")},setupTableListeners(t){const o=[`${e.PITY_TABLE} input`,"#rate-up-table select"].join(",");document.querySelectorAll(o).forEach(n=>{n.addEventListener("input",()=>this.queueSave(t))})},queueSave(t){clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>this.saveTables(t),this.DEBOUNCE_TIME)},_save(t,o){try{localStorage.setItem(t,JSON.stringify(o))}catch(n){console.error("Storage error:",n),this._handleStorageError()}},_load(t){try{const o=localStorage.getItem(t);return o?JSON.parse(o):null}catch(o){return console.error("Load error:",o),null}},_validate(t,o){return t?typeof t._schema>"u"?t:t._schema!==b[o]?(console.warn(`Schema version mismatch for ${o}`),null):t:null},_handleStorageError(){Object.values(r).forEach(t=>{try{localStorage.removeItem(t)}catch(o){console.error("Cleanup failed:",o)}})}}}function Ce(){document.querySelectorAll(".tab-nav").forEach(e=>{e.addEventListener("click",r=>{if(!r.target.matches(".tab-link[data-tab-target]"))return;const t=r.target,o=t.closest(".tab-panel-card"),n=t.dataset.tabTarget,i=o.querySelector(n);if(!i){console.error(`Tab target not found: ${n}`);return}o.querySelectorAll(".tab-link").forEach(s=>s.classList.remove("active")),o.querySelectorAll(".tab-pane").forEach(s=>s.classList.remove("active")),t.classList.add("active"),i.classList.add("active")})})}class Ae{constructor(e){this.tourSteps=[],this.currentTourStepIndex=0,this.isTourActive=!1,this.isShowingHelp=!1,this.pausedTourStepIndex=-1,this.currentHighlightedElement=null,this.observers=null,this.currentDisplayConfig=null,this.boundHandleWindowResize=this.handleReposition.bind(this),this.boundHandleHighlightUpdate=this.handleHighlightUpdate.bind(this),this.container=document.createElement("div"),this.container.id="chibi-container",this.container.innerHTML=`
            <div class="chibi-tutorial-overlay-piece" data-overlay="top"></div>
            <div class="chibi-tutorial-overlay-piece" data-overlay="bottom"></div>
            <div class="chibi-tutorial-overlay-piece" data-overlay="left"></div>
            <div class="chibi-tutorial-overlay-piece" data-overlay="right"></div>
        `,this.container.innerHTML+=e,document.body.appendChild(this.container),this.overlays={top:this.container.querySelector('[data-overlay="top"]'),bottom:this.container.querySelector('[data-overlay="bottom"]'),left:this.container.querySelector('[data-overlay="left"]'),right:this.container.querySelector('[data-overlay="right"]')},this.chibiGroup=this.container.querySelector(".chibi-group"),this.bubbleText=this.container.querySelector(".bubble-text"),this.nextButton=this.container.querySelector(".btn--tutorial_next"),this.endButton=this.container.querySelector(".btn--tutorial_end"),this.handleNext=this.handleNext.bind(this),this.hide=this.hide.bind(this),this.handleReposition=this.handleReposition.bind(this),this.nextButton.addEventListener("click",this.handleNext),this.endButton.addEventListener("click",this.hide)}startTour(e){if(localStorage.setItem("tutorialSeen","true"),!e||e.length===0){console.error("ChibiTutorial: No steps provided for the tour.");return}this.tourSteps=e,this.pausedTourStepIndex===-1?this.currentTourStepIndex=0:(this.currentTourStepIndex=this.pausedTourStepIndex,this.pausedTourStepIndex=-1),this.isTourActive=!0,this.isShowingHelp=!1,this.nextButton.textContent=">>",this.endButton.style.display="inline-block",this.#a(),this.showTourStep(this.currentTourStepIndex)}showTourStep(e){if(e>=this.tourSteps.length){this.hide();return}const r=this.tourSteps[e];this.showDisplay(r)}showTutorialIfNeeded(){if(!localStorage.getItem("tutorialSeen")){const r=document.getElementById("start-tour-btn");r&&(r.classList.add("attention-grabber"),setTimeout(()=>{r.classList.remove("attention-grabber")},1e4))}}showDisplay(e){this.currentDisplayConfig=e,this.#r(),this.chibiGroup.classList.remove("chibi-on-left"),e.chibiSide==="left"&&this.chibiGroup.classList.add("chibi-on-left");const r=this.container.querySelector(".bubble-wrapper");r.classList.remove("bubble-wrapper--big","bubble-wrapper--small");const t=e.size;t&&r.classList.add(`bubble-wrapper--${t}`),this.bubbleText.innerHTML=e.text,this.container.style.display="block",this.container.style.height=`${document.documentElement.scrollHeight}px`;let o=null,n=!1;if(e.clickTab){const i=document.querySelector(e.clickTab);i?(i.dispatchEvent(new Event("click",{bubbles:!0})),n=!0):console.warn(`ChibiTutorial: Tab button not found for selector "${e.clickTab}".`)}if(e.action==="click"){const i=document.querySelector(e.element);i?(i.dispatchEvent(new Event("click",{bubbles:!0})),n=!0):console.error(`ChibiTutorial: Element not found for selector "${e.element}" to perform action "${e.action}".`)}if(e.element){o=document.querySelector(e.element);const i=document.querySelector(".tutorial-chibi");if(this.#e(o),!o){console.error(`ChibiTutorial: Element not found for selector "${e.element}". Skipping display.`),this.isTourActive&&this.handleNext();return}n&&setTimeout(()=>{this.currentHighlightedElement=o,this.currentHighlightedElement.classList.add("chibi-tutorial-focused-element"),this.observers&&this.observers.targetObserver&&this.observers.targetObserver.observe(this.currentHighlightedElement),this.#e(this.currentHighlightedElement)},50);const s=[o,this.chibiGroup,i];this.#n(s)}else this.#e(null),this.chibiGroup.scrollIntoView({behavior:"smooth",block:"nearest"});window.addEventListener("resize",this.boundHandleWindowResize)}#n(e){if(e.length===0)return;const r=this.getCombinedBoundingRect(e),t=document.createElement("div");t.style.cssText=`
        position: absolute;
        top: ${r.top}px;
        height: ${r.height}px;
        pointer-events: none;
        visibility: hidden;
    `,document.body.appendChild(t),t.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>{document.body.removeChild(t)},1e3)}getCombinedBoundingRect(e){const r=e.map(l=>l.getBoundingClientRect()),t=Math.min(...r.map(l=>l.left)),o=Math.min(...r.map(l=>l.top)),n=Math.max(...r.map(l=>l.right)),i=Math.max(...r.map(l=>l.bottom)),s=10;return{top:o+window.pageYOffset-s,left:t+window.pageXOffset-s,width:n-t+s*2,height:i-o+s*2,right:n+window.pageXOffset+s,bottom:i+window.pageYOffset+s}}hide(){this.container.style.display="none",this.chibiGroup.classList.remove("chibi-on-left"),this.#r(),this.#i(),this.currentDisplayConfig=null,this.isShowingHelp||(this.isTourActive=!1,this.currentTourStepIndex=0,this.pausedTourStepIndex=-1),this.isShowingHelp=!1,this.nextButton.textContent="Next",this.endButton.style.display="inline-block",window.removeEventListener("resize",this.boundHandleWindowResize)}#r(){this.currentHighlightedElement&&(this.observers&&this.observers.targetObserver&&this.observers.targetObserver.unobserve(this.currentHighlightedElement),this.currentHighlightedElement.classList.remove("chibi-tutorial-focused-element"),this.currentHighlightedElement=null)}handleNext(){this.isTourActive?(this.currentTourStepIndex++,this.showTourStep(this.currentTourStepIndex)):this.isShowingHelp?(this.hide(),this.pausedTourStepIndex!==-1&&this.startTour(this.tourSteps)):this.hide()}showHelp(e,r=null){if(!e){console.warn("ChibiTutorial: No help configuration provided.");return}let t=null;if(e.tourStepId){const o=this.tourSteps.findIndex(n=>n&&n.id===e.tourStepId);if(o!==-1)t={...this.tourSteps[o]};else if(console.warn(`ChibiTutorial: Tour step with ID '${e.tourStepId}' not found.`),e.text)t={text:e.text,element:e.element,clickTab:e.clickTab,position:e.position||"bottom",chibiSide:e.chibiSide||"right",size:e.size||""};else return}else e.text&&(t={text:e.text,element:e.element,clickTab:e.clickTab,position:e.position||"bottom",chibiSide:e.chibiSide||"right",size:e.size||""});!t.element&&r&&(t.element=r),t&&(this.isTourActive&&(this.pausedTourStepIndex=this.currentTourStepIndex,this.isTourActive=!1),this.isShowingHelp=!0,this.nextButton.textContent="OK",this.endButton.style.display="none",this.showDisplay(t))}handleHighlightUpdate(){window.requestAnimationFrame(()=>{if(!this.currentHighlightedElement||!this.isTourActive&&!this.isShowingHelp)return;this.container.style.height=`${document.documentElement.scrollHeight}px`;const e=this.currentHighlightedElement.getBoundingClientRect(),r={top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX,width:e.width,height:e.height};this.#t(r)})}handleReposition(){window.requestAnimationFrame(()=>{!this.currentHighlightedElement||!this.isTourActive&&!this.isShowingHelp||(this.container.style.height=`${document.documentElement.scrollHeight}px`,this.#e(this.currentHighlightedElement))})}#e(e){if(e===null){const r=window.innerWidth,t=window.innerHeight,o=window.scrollX||window.pageXOffset,n=window.scrollY||window.pageYOffset,i=this.chibiGroup.getBoundingClientRect(),s=i.width,l=i.height,u=o+(r-s)/2,c=n+(t-l)/2;this.chibiGroup.style.left=`${u}px`,this.chibiGroup.style.top=`${c}px`,this.chibiGroup.style.transform="",this.#t(e)}else{this.container.style.height=`${document.documentElement.scrollHeight}px`;const r=e.getBoundingClientRect(),t={top:r.top+window.scrollY,bottom:r.bottom+window.scrollY,left:r.left+window.scrollX,right:r.right+window.scrollX,width:r.width,height:r.height};this.#t(t),this.#o(t)}}#o(e){const r=this.currentDisplayConfig||{},t=document.querySelector(".tutorial-chibi"),o=this.chibiGroup.getBoundingClientRect(),n=t.getBoundingClientRect(),i=[this.chibiGroup,t],s=this.getCombinedBoundingRect(i),l=10;let u;window.innerWidth<900||window.innerWidth<620?r.position==="top"?u="top":u="bottom":u=r.position||"bottom";let c,d;switch(u){case"top":c=e.top-s.height+l,d=e.left+e.width/2-s.width/2;break;case"right":c=e.top+e.height/2-s.height/2+l/2,d=e.right+l;break;case"left":c=e.top+e.height/2-s.height/2+l/2,d=e.left-s.width+l;break;default:c=e.bottom+l,d=e.left+e.width/2-s.width/2;break}n.left<o.left&&(d=d-(n.left-o.left)),n.top<o.top&&(c=c-n.top+o.top),(d+s.width>window.innerWidth||d<l)&&(d=l),this.chibiGroup.style.left=`${d}px`,this.chibiGroup.style.top=`${c}px`,this.chibiGroup.style.transform=""}#t(e){if(!e){this.overlays.top.style.cssText="width: 100%; height: 100%;",this.overlays.bottom.style.cssText="width: 0; height: 0;",this.overlays.left.style.cssText="width: 0; height: 0;",this.overlays.right.style.cssText="width: 0; height: 0;";return}this.overlays.left.style.cssText=`top: 0; left: 0; width: ${e.left}px; height: 100%;`,this.overlays.right.style.cssText=`top: 0; left: ${e.right}px; width: calc(100% - ${e.right}px); height: 100%;`,this.overlays.top.style.cssText=`top: 0; left: ${e.left}px; width: ${e.width}px; height: ${e.top}px;`,this.overlays.bottom.style.cssText=`top: ${e.bottom}px; left: ${e.left}px; width: ${e.width}px; height: calc(100% - ${e.bottom}px);`}#a(){this.observers={targetObserver:new ResizeObserver(this.boundHandleHighlightUpdate),bodyObserver:new ResizeObserver(this.boundHandleHighlightUpdate),mutationObserver:new MutationObserver(this.boundHandleHighlightUpdate)},this.observers.bodyObserver&&this.observers.bodyObserver.observe(document.body),this.observers.mutationObserver&&this.observers.mutationObserver.observe(document.body,{attributes:!0,childList:!0,subtree:!0})}#i(){this.observers&&(this.observers.targetObserver&&this.observers.targetObserver.disconnect(),this.observers.bodyObserver&&this.observers.bodyObserver.disconnect(),this.observers.mutationObserver&&this.observers.mutationObserver.disconnect(),this.observers=null)}showError(e,r=".tab-panel-card"){const t={text:`<p style="color: #ff6b6b;">${e}</p>`,element:r,position:"right",chibiSide:"right",size:"small"};this.showHelp(t)}}const g=(a,e=!1)=>a?e?a.checked:parseInt(a.value)||0:null;function xe(a,e,r,t){const o=document.getElementById("pity-panel"),n=document.getElementById("constellation-panel"),i=e.paths;if(!o||!n)return console.error("Required tab panels not found. Cannot get page configuration."),null;const s=(v,T)=>{if(!T)return[];const w=T.querySelector("#constellation-table");if(!w)return console.warn("Could not find the constellation table inside the panel:",T),[];const _=w.querySelectorAll(`tr[data-rarity="${v}"] .custom-input`);return Array.from(_).map($=>parseInt($.value)||0)},l=o.querySelector(`${r.PITY_ROW}[data-banner="character"]`),u=o.querySelector(`${r.PITY_ROW}[data-banner="weapon"]`),c=te(i),d={},h={},p={},f={},y={};return t.isCharacter&&(d.char=g(l.querySelector('[data-control="pity-5"]')),h.char=g(l.querySelector('[data-control="pity-4"]')),p.char=g(l.querySelector(".guarantee-5"),!0),f.char=g(l.querySelector(".guarantee-4"),!0),t.isCapRad&&(y.capRad=g(l.querySelector('[data-control="capRad"]')))),t.isWeapon&&(d.wep=g(u.querySelector('[data-control="pity-5"]')),h.wep=g(u.querySelector('[data-control="pity-4"]')),p.wep=g(u.querySelector(".guarantee-5"),!0),f.wep=g(u.querySelector(".guarantee-4"),!0),t.isEpitPath&&(y.epitPath=g(u.querySelector('[data-control="epPath"]')))),{SSR:{pity:d,guarantee:p,special:y,consCountStandard:s(5,n),pullPlan:c.typeArray,cashbackRoadmap:c.cashbackArray},SR:{pity:h,guarantee:f,rateUps:re(),consCount:s(4,n)}}}function Pe(){const a=document.querySelectorAll(".row"),e=[];return Array.from(a).slice(1).forEach(t=>{const o=t.dataset.group,n=t.querySelector(".type-selector")?.value||"char",i=t.querySelector(".first-select")?.value||"None",s=t.querySelector(".second-select")?.value||"None";e.push({group:o,type:n,from:i,to:s})}),{pullPlan:e}}function te(a){const e=document.querySelectorAll(".row"),r=[],t=[],o=Array.from(e).slice(1);let n=0;return o.forEach(i=>{const s=i.querySelector(".type-selector")?.value||"char",l=i.querySelector(".first-select")?.value||"None",u=i.querySelector(".second-select")?.value||"None",c=s==="char"?a.char:a.wep,d=c.indexOf(l),h=c.indexOf(u);if(d===-1||h===-1||d>=h)return;const p=h-d;let f=d,y=0;for(let v=0;v<p;v++)s==="char"&&f===0?y="none":y="regular",r.push({type:s,bannerCount:n}),t.push(y),f++;n++}),{typeArray:r,cashbackArray:t}}function Ie(a){const e=document.querySelectorAll(".row"),r=Array.from(e).slice(1);let t=["None"];const o=a.char,n=a.wep;return r.forEach(i=>{const s=i.querySelector(".type-selector")?.value||"char",l=i.querySelector(".first-select")?.value||"None",u=i.querySelector(".second-select")?.value||"None",c=s==="char"?o:n,d=c.indexOf(l),h=c.indexOf(u);if(d===-1||h===-1||d>=h)return;const p=c.slice(d+1,h+1);t.push(...p)}),t}function re(){const a=document.querySelectorAll("#rate-up-table select.custom-select");let e=[];return a.length===0?(console.error("Could not find any rate-up select elements."),[]):(a.forEach(r=>{const t=r.value;t!=="unknown"&&(t!==void 0?e.push(t):console.warn(`Invalid or unhandled rate-up value found: "${t}"`))}),e)}function Oe(){const a=document.querySelector(".mode-label.active").getAttribute("data-target");if(a==="probability")return{type:a,value:parseInt(document.querySelector('[data-control="probability"]').value)/100};if(a==="pulls")return{type:a,value:parseInt(document.querySelector('[data-control="pulls"]').value)}}let m=null;function ne(){const a=document.getElementById("myChart").getContext("2d");m=new Chart(a,{type:"line",data:{labels:[],datasets:[]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#b8c2d0",callback:function(e){return(e*100).toFixed(0)+"%"}},grid:{color:"rgba(58, 58, 106, 0.5)"},beginAtZero:!0,min:0,max:1},x:{ticks:{color:"#b8c2d0"},grid:{color:"rgba(58, 58, 106, 0.5)"}}},plugins:{legend:{labels:{color:"#f5f5f5",sort:(e,r)=>e.datasetIndex-r.datasetIndex}},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(e){let r=e.dataset.label||"";return r&&(r+=": "),r+=(e.parsed.y*100).toFixed(2)+"%",r}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}}})}function oe(a){const e=["#FF9800","#9C27B0","#E91E63","#00BCD4"];return e[a%e.length]}function ae(a){const e=["rgba(255, 99, 132, 0.1)","rgba(255, 159, 64, 0.1)","rgba(255, 205, 86, 0.1)","rgba(75, 192, 192, 0.1)","rgba(153, 102, 255, 0.1)"];return e[(a-2)%e.length]}function Be(a,e,r){m||ne();const t=a.length,o=r.slice(1);m.data.labels=e,m.data.datasets=a.map((n,i)=>{const s=i===0?"#2196F3":i===1?"#4CAF50":oe(i);return{label:o[i],data:n,borderColor:s,backgroundColor:i===0?"rgba(33, 150, 243, 0.1)":i===1?"rgba(76, 175, 80, 0.1)":ae(i),fill:!0,tension:.4,order:t-i,borderWidth:3,pointRadius:0,pointHoverRadius:5}}),m.update()}function Ne(a){let e=a[0].length,r=Array.from({length:e-1},()=>Array.from({length:a.length+1},()=>0)),t=[0];for(let o=0;o<a.length;o++){let n=0;for(const c of a[o])n+=c;let i=0;const s=o+1;t.push(s);const l=a[o],u=l.length-1;for(let c=u;c>0;c--)i+=l[c],r[c-1][s]=i/n}return{data:r,labels:t}}function Re(a){document.querySelector(".mode-label.active").getAttribute("data-target")==="probability"?document.querySelector('.input-lock-container input[data-control="pulls"]').value=ie(a,parseInt(document.querySelector('[data-control="probability"]').value)):document.querySelector('.input-lock-container input[data-control="probability"]').value=se(a,parseInt(document.querySelector('[data-control="pulls"]').value))}function ie(a,e){e===100&&(e=99.9);let r=a.length-1,t=!0,o=0,n=0;for(;t;)a[r][n]>e/100&&(o=n,t=!1),n++;return o}function se(a,e){let r=a.length-1;return a[r].length<=e?100:Math.round(a[r][e]*100)}export{ge as B,Ae as C,be as D,O as I,G as O,S,ye as U,Ne as a,Pe as b,qe as c,Ie as d,xe as e,Ce as f,Oe as g,ve as h,le as i,ce as j,Se as k,Te as l,Le as m,ue as n,de as o,Ee as p,fe as q,Re as r,we as s,pe as t,Be as u,me as v,he as w,L as x};
